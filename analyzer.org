#+STARTUP: indent

* Analyzer

** framework
#+begin_src python :tangle ${BUILDDIR}/analyzer.py
  from typing import List, NewType, Union
  from abc import ABC, abstractmethod
  from parameter_fsm import ActionDelegate as ParameterActionDelegate, GuardDelegate as ParameterGuardDelegate, VariableDelegate as ParameterVariableDelegate, StateMachine as ParameterStateMachine
  from action_fsm import ActionDelegate as ActionActionDelegate, GuardDelegate as ActionGuardDelegate, VariableDelegate as ActionVariableDelegate, StateMachine as ActionStateMachine
  from guard_fsm import ActionDelegate as GuardActionDelegate, GuardDelegate as GuardGuardDelegate, VariableDelegate as GuardVariableDelegate, StateMachine as GuardStateMachine
  from model import Parameter
  from semantic import Expression, Assignment, Identifier, Literal, Delimiter, Call, BoolExpression, UnaryBoolExpression, BinaryBoolExpression, CompareExpression, Accessor, Fun, Var, Type, UnionType, ListType, MapType


  <<utility>>


  <<parameter>>


  <<action>>


  <<guard>>
#+end_src

** parameter syntaxer
*** framework
#+begin_src python :noweb-ref parameter
  <<parameter-context>>


  <<parameter-delegate>>


  class ParameterSyntaxer:

    def __init__(self):
      self._fsm = ParameterStateMachine(_ParameterActionDelegate(), None, None)
      self._ctx = _ParameterContext(self._fsm)

    def identifier(self, id):
      self._consume_queue()
      self._ctx.input = id
      self._fsm.identifier(self._ctx)
      self._consume_queue()

    def delimiter(self, d):
      self._consume_queue()
      self._ctx.input = d
      dstr = str(d)
      if dstr == ',':
        self._fsm.comma(self._ctx)
      elif dstr == ':':
        self._fsm.colon(self._ctx)
      elif dstr == '|':
        self._fsm.pipe(self._ctx)
      elif dstr == '[':
        self._fsm.open_bracket(self._ctx)
      elif dstr == ']':
        self._fsm.close_bracket(self._ctx)
      elif dstr == '{':
        self._fsm.open_brace(self._ctx)
      elif dstr == '}':
        self._fsm.close_brace(self._ctx)
      self._consume_queue()

    def eof(self):
      self._consume_queue()
      self._ctx.input = '$$'
      self._fsm.dollar_dollar(self._ctx)
      self._consume_queue()

    def result(self):
      return self._ctx.parameters

    def _consume_queue(self):
      while len(self._ctx.queue) > 0:
        n = self._ctx.queue[0]
        self._ctx.queue = self._ctx.queue[1:]
        self._ctx.input = n
        self._feed(n)
      while len(self._ctx.delay_queue) > 0:
        while len(self._ctx.queue) > 0:
          n = self._ctx.queue[0]
          self._ctx.queue = self._ctx.queue[1:]
          self._ctx.input = n
          self._feed(n)
        d = self._ctx.delay_queue[0]
        self._ctx.delay_queue = self._ctx.delay_queue[1:]
        self._ctx.input = d
        self._feed(d)

    def _feed(self, n):
      self._ctx.input = n
      if isinstance(n, Var):
        self._fsm.var(self._ctx)
      elif isinstance(n, Type):
        self._fsm.type(self._ctx)
      elif isinstance(n, UnionType):
        self._fsm.union_type(self._ctx)
      elif isinstance(n, ListType):
        self._fsm.list_type(self._ctx)
      elif isinstance(n, MapType):
        self._fsm.map_type(self._ctx)
      elif isinstance(n, Parameter):
        self._fsm.parameter(self._ctx)
      elif isinstance(n, list):
        self._fsm.parameters(self._ctx)
      elif isinstance(n, str) and n == '$$':
        self._fsm.dollar_dollar(self._ctx)
      elif isinstance(n, Identifier):
        self._fsm.identifier(self._ctx)
      elif isinstance(n, Delimiter):
        dstr = str(n)
        if dstr == ',':
          self._fsm.comma(self._ctx)
        elif dstr == ':':
          self._fsm.colon(self._ctx)
        elif dstr == '|':
          self._fsm.pipe(self._ctx)
        elif dstr == '[':
          self._fsm.open_bracket(self._ctx)
        elif dstr == ']':
          self._fsm.close_bracket(self._ctx)
        elif dstr == '{':
          self._fsm.open_brace(self._ctx)
        elif dstr == '}':
          self._fsm.close_brace(self._ctx)


  <<parameter-adapter>>
#+end_src
*** bnf
#+begin_src text :tangle ${BUILDDIR}/parameter_fsm.bnf
  target = parameters $$

  parameters = parameters ',' parameter
             | parameter

  parameter = var ':' type

  var = identifier

  type = identifier
       | list-type
       | map-type
       | union-type

  union-type = union-type '|' identifier
             | union-type '|' list-type
             | union-type '|' map-type
             | identifier '|' identifier
             | identifier '|' list-type
             | identifier '|' map-type
             | list-type '|' identifier
             | list-type '|' list-type
             | list-type '|' map-type
             | map-type '|' identifier
             | map-type '|' list-type
             | map-type '|' map-type

  list-type = '[' type ']'

  map-type = '{' type ':' type '}'
#+end_src
*** context
#+begin_src python :noweb-ref parameter-context
  class _ParameterContext:
    parameters: List[Parameter]

    def __init__(self, fsm = None):
      self.fsm = fsm
      self.queue = []
      self.delay_queue = []
      self.state_stack = []
      self.value_stack = []
      self.parameters = []
      self.input = None
#+end_src
*** delegate
#+begin_src python :noweb-ref parameter-delegate
  class _ParameterActionDelegate(ParameterActionDelegate):

    def shift(self, ctx):
      ctx.state_stack.append(ctx.fsm.state)
      ctx.value_stack.append(ctx.input)

    def syntax_error(self, ctx):
      print("syntax error in parameter syntaxer")
      print("current state: %d" % ctx.fsm.state)
      print("stack: %s" % ctx.value_stack)
      print("state stack: %s" % ctx.state_stack)
      print("input: %s" % ctx.input)
      exit(1)

    def reduce_1_to_parameters(self, ctx):
      ctx.fsm.state = ctx.state_stack.pop()
      parameter = ctx.value_stack.pop()
      parameters = [ parameter ]
      ctx.queue.append(parameters)

    def reduce_1_to_var(self, ctx):
      var = ctx.value_stack.pop()
      ctx.fsm.state = ctx.state_stack.pop()
      ctx.queue.append(Var(var))

    def reduce_2_to_target(self, ctx):
      ctx.fsm.state = ctx.state_stack.pop()
      ctx.value_stack.pop()
      ctx.fsm.state = ctx.state_stack.pop()
      parameters = ctx.value_stack.pop()
      if isinstance(parameters, list):
        ctx.parameters = parameters
      else:
        ctx.parameters.append(parameters)

    def reduce_3_to_parameters(self, ctx):
      ctx.fsm.state = ctx.state_stack.pop()
      parameter = ctx.value_stack.pop()
      ctx.fsm.state = ctx.state_stack.pop()
      ctx.value_stack.pop()
      ctx.fsm.state = ctx.state_stack.pop()
      parameters = ctx.value_stack.pop()
      parameters.append(parameter)
      ctx.queue.append(parameters)

    def reduce_3_to_parameter(self, ctx):
      ctx.fsm.state = ctx.state_stack.pop()
      type = ctx.value_stack.pop()
      ctx.fsm.state = ctx.state_stack.pop()
      ctx.value_stack.pop()
      ctx.fsm.state = ctx.state_stack.pop()
      var = ctx.value_stack.pop()
      parameter = Parameter(var, type)
      ctx.queue.append(parameter)

    def enqueue(self, ctx):
      ctx.delay_queue.append(ctx.input)

    def reduce_1_to_type(self, ctx):
      ctx.fsm.state = ctx.state_stack.pop()
      type = ctx.value_stack.pop()
      if isinstance(type, Identifier):
        t = Type(0, type)
      else:
        t = Type(type.kind, type)
      ctx.queue.append(t)

    def reduce_3_to_union_type(self, ctx):
      ctx.fsm.state = ctx.state_stack.pop()
      a = ctx.value_stack.pop()
      ctx.fsm.state = ctx.state_stack.pop()
      ctx.value_stack.pop()
      ctx.fsm.state = ctx.state_stack.pop()
      b = ctx.value_stack.pop()
      if isinstance(b, UnionType):
        b.types.append(a)
        ctx.queue.append(b)
      else:
        u = UnionType()
        u.types.append(b)
        u.types.append(a)
        ctx.queue.append(u)

    def reduce_3_to_list_type(self, ctx):
      ctx.fsm.state = ctx.state_stack.pop()
      ctx.value_stack.pop()
      ctx.fsm.state = ctx.state_stack.pop()
      type = ctx.value_stack.pop()
      ctx.fsm.state = ctx.state_stack.pop()
      ctx.value_stack.pop()
      ctx.queue.append(ListType(type))

    def reduce_5_to_map_type(self, ctx):
      ctx.fsm.state = ctx.state_stack.pop()
      ctx.value_stack.pop()
      ctx.fsm.state = ctx.state_stack.pop()
      valtype = ctx.value_stack.pop()
      ctx.fsm.state = ctx.state_stack.pop()
      ctx.value_stack.pop()
      ctx.fsm.state = ctx.state_stack.pop()
      keytype = ctx.value_stack.pop()
      ctx.fsm.state = ctx.state_stack.pop()
      ctx.value_stack.pop()
      ctx.queue.append(MapType(keytype, valtype))
#+end_src
*** lex adapter
#+begin_src python :noweb-ref parameter-adapter
  class ParameterLexerAdapter:

    def __init__(self, syntaxer: ParameterSyntaxer):
      self._syntaxer = syntaxer

    def on_call(self, token):
      if isinstance(token, Identifier):
        self._syntaxer.identifier(token)
      elif isinstance(token, Delimiter):
        self._syntaxer.delimiter(token)
      else:
        print('Unknown token in parameter lexer adapter: %s' % (repr(token)))
        exit(1)
#+end_src

** guard syntaxer
*** framework
#+begin_src python :noweb-ref guard
  <<guard-context>>


  <<guard-delegate>>


  class GuardSyntaxer:

    def __init__(self):
      self._fsm = GuardStateMachine(_GuardActionDelegate(), None, None)
      self._ctx = _GuardContext(self._fsm)

    def identifier(self, id):
      self._consume_queue()
      self._fsm.identifier(self._ctx, id)
      self._consume_queue()

    def literal(self, l):
      self._consume_queue()
      self._fsm.literal(self._ctx, l)
      self._consume_queue()

    def delimiter(self, d):
      self._consume_queue()
      self._fsm.delimiter(self._ctx, d)
      self._consume_queue()

    def eof(self):
      self._consume_queue()
      self._fsm.eof(self._ctx, 0)
      self._consume_queue()

    def result(self):
      return self._ctx.guard

    def _consume_queue(self):
      while len(self._ctx.queue) > 0:
        n = self._ctx.queue[0]
        self._ctx.queue = self._ctx.queue[1:]
        self._feed(n)
      while len(self._ctx.delay_queue) > 0:
        while len(self._ctx.queue) > 0:
          n = self._ctx.queue[0]
          self._ctx.queue = self._ctx.queue[1:]
          self._feed(n)
        d = self._ctx.delay_queue[0]
        self._ctx.delay_queue = self._ctx.delay_queue[1:]
        self._feed(d)

    def _feed(self, n):
      if isinstance(n, BoolExpression):
        self._fsm.bool_expression(self._ctx, n)
      elif isinstance(n, CompareExpression):
        self._fsm.compare_expression(self._ctx, n)
      elif isinstance(n, Expression):
        self._fsm.expression(self._ctx, n)
      elif isinstance(n, Call):
        self._fsm.call(self._ctx, n)
      elif isinstance(n, Fun):
        self._fsm.fun(self._ctx, n)
      elif isinstance(n, Accessor):
        self._fsm.accessor(self._ctx, n)
      elif isinstance(n, Identifier):
        self._fsm.identifier(self._ctx, n)
      elif isinstance(n, Literal):
        self._fsm.literal(self._ctx, n)
      elif isinstance(n, Delimiter):
        self._fsm.delimiter(self._ctx, n)
      elif isinstance(n, list):
        self._fsm.operands(self._ctx, n)
      elif isinstance(n, int):
        self._fsm.eof(self._ctx, n)

  <<guard-adapter>>
#+end_src
*** bnf
#+begin_src text
  guard = bool-expression

  bool-expression = bool-expression and bool-expression
                  | bool-expression or bool-expression
                  | not boo-expression
                  | compare-expression
                  | ( bool-expression )
                  | expression

  compare-expression = expression == expression
                     | expression != expression
                     | expression >  expression
                     | expression >= expression
                     | expression <  expression
                     | expression <= expression

  expression = call
             | accessor
             | literal
             | identifier

  call = fun ( operands )
       | fun ( )

  fun = fun identifier
      | fun literal
      | identifier

  operands = expression
           | operands , expression

  accessor = accessor . identifier
           | identifier . identifier
#+end_src

*** fsm defination
#+begin_src text :tangle ${BUILDDIR}/guard_fsm.txt
  +----------------------------------------+---------------------------+---------------------+--------------------------------------------+-------------------------------------------+--------------------------------------------+----------------------------------------+----------------------------------------+-----------------------------------------+-----------------------------------------+----------------------------------------+-----------------------------------------+----------------------------------------+-----------------------------------------+----------------------------------------+----------------------------------------+----------------------------------------+------------------------------------------+----------------------------+----------------+----------------------------+--------------------------------------------+-------------------------------+-----------------------+
  | state\event                            | identifier(i: Identifier) | literal(l: Literal) | identifier(i: Identifier)[i.name == "and"] | identifier(i: Identifier)[i.name == "or"] | identifier(i: Identifier)[i.name == "not"] | delimiter(d: Delimiter)[d.name == "("] | delimiter(d: Delimiter)[d.name == ")"] | delimiter(d: Delimiter)[d.name == "=="] | delimiter(d: Delimiter)[d.name == "!="] | delimiter(d: Delimiter)[d.name == ">"] | delimiter(d: Delimiter)[d.name == ">="] | delimiter(d: Delimiter)[d.name == "<"] | delimiter(d: Delimiter)[d.name == "<="] | delimiter(d: Delimiter)[d.name == ","] | delimiter(d: Delimiter)[d.name == "."] | bool_expression(e: BoolExpression)     | compare_expression(e: CompareExpression) | expression(e: Expression)  | call(c: Call)  | fun(f: Fun)                | operands(o: [Call | Literal | Identifier]) | accessor(a: Accessor)         | eof(e: int)           |
  +----------------------------------------+---------------------------+---------------------+--------------------------------------------+-------------------------------------------+--------------------------------------------+----------------------------------------+----------------------------------------+-----------------------------------------+-----------------------------------------+----------------------------------------+-----------------------------------------+----------------------------------------+-----------------------------------------+----------------------------------------+----------------------------------------+----------------------------------------+------------------------------------------+----------------------------+----------------+----------------------------+--------------------------------------------+-------------------------------+-----------------------+
  |                                        |                           |                     |                                            |                                           | shift(i)                                   | shift(d)                               |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     |                                            |                                           | ----                                       | ----                                   |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | guard -> · bool-expr $$                |                           |                     |                                            |                                           | bool-expr -> not · bool-expr               | bool-expr -> ( · bool-expr )           |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | bool-expr -> · bool-expr and bool-expr |                           |                     |                                            |                                           | bool-expr -> · bool-expr and bool-expr     | bool-expr -> · bool-expr and bool-expr |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | bool-expr -> · bool-expr or bool-expr  |                           |                     |                                            |                                           | bool-expr -> · bool-expr or bool-expr      | bool-expr -> · bool-expr or bool-expr  |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | bool-expr -> · not bool-expr           |                           |                     |                                            |                                           | bool-expr -> · not bool-expr               | bool-expr -> · not bool-expr           |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | bool-expr -> · cmp-expr                |                           |                     |                                            |                                           | bool-expr -> · cmp-expr                    | bool-expr -> · cmp-expr                |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | bool-expr -> · ( bool-expr )           |                           |                     |                                            |                                           | bool-expr -> · ( bool-expr )               | bool-expr -> · ( bool-expr )           |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | bool-expr -> · expr                    |                           |                     |                                            |                                           | bool-expr -> · expr                        | bool-expr -> · expr                    |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | cmp-expr -> · expr == expr             |                           |                     |                                            |                                           | cmp-expr -> · expr == expr                 | cmp-expr -> · expr == expr             |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | cmp-expr -> · expr != expr             |                           |                     |                                            |                                           | cmp-expr -> · expr != expr                 | cmp-expr -> · expr != expr             |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | cmp-expr -> · expr >  expr             |                           |                     |                                            |                                           | cmp-expr -> · expr >  expr                 | cmp-expr -> · expr >  expr             |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | cmp-expr -> · expr >= expr             |                           |                     |                                            |                                           | cmp-expr -> · expr >= expr                 | cmp-expr -> · expr >= expr             |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | cmp-expr -> · expr <  expr             |                           |                     |                                            |                                           | cmp-expr -> · expr <  expr                 | cmp-expr -> · expr <  expr             |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | cmp-expr -> · expr <= expr             |                           |                     |                                            |                                           | cmp-expr -> · expr <= expr                 | cmp-expr -> · expr <= expr             |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | expr -> · call                         |                           |                     |                                            |                                           | expr -> · call                             | expr -> · call                         |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | expr -> · accessor                     |                           |                     |                                            |                                           | expr -> · accessor                         | expr -> · accessor                     |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | expr -> · lit                          |                           |                     |                                            |                                           | expr -> · lit                              | expr -> · lit                          |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          | shift(e)                   |                |                            |                                            |                               |                       |
  | expr -> · id                           |                           |                     |                                            |                                           | expr -> · id                               | expr -> · id                           |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          | ----                       |                |                            |                                            |                               |                       |
  | call -> · fun ( operands )             |                           |                     |                                            |                                           | call -> · fun ( operands )                 | call -> · fun ( operands )             |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          | bool-expr -> expr ·        |                |                            |                                            |                               |                       |
  | call -> · fun ( )                      |                           |                     |                                            |                                           | call -> · fun ( )                          | call -> · fun ( )                      |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          | cmp-expr -> expr · == expr |                | shift(f)                   |                                            |                               |                       |
  | fun -> · fun id                        | shift(i)                  |                     |                                            |                                           | fun -> · fun id                            | fun -> · fun id                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        | shift(e)                               |                                          | cmp-expr -> expr · != expr |                | ----                       |                                            |                               |                       |
  | fun -> · fun lit                       | ----                      | shift(l)            | syntax error                               | syntax error                              | fun -> · fun lit                           | fun -> · fun lit                       | syntax error                           | syntax error                            | syntax error                            | syntax error                           | syntax error                            | syntax error                           | syntax error                            | syntax error                           | syntax error                           | ----                                   | shift(e)                                 | cmp-expr -> expr · >  expr | shift(c)       | call -> fun · ( operands ) | syntax error                               | shift(a)                      | syntax error          |
  | fun -> · id                            | expr -> id ·              | reduce to expr      | quit                                       | quit                                      | fun -> · id                                | fun -> · id                            | quit                                   | quit                                    | quit                                    | quit                                   | quit                                    | quit                                   | quit                                    | quit                                   | quit                                   | guard -> bool-expr · $$                | reduce 1 to bool expr                    | cmp-expr -> expr · >= expr | reduce to expr | call -> fun · ( )          | quit                                       | ----                          | quit                  |
  | accessor -> · accessor dot id          | fun -> id ·               | ----                | ----                                       | ----                                      | accessor -> · accessor dot id              | accessor -> · accessor dot id          | ----                                   | ----                                    | ----                                    | ----                                   | ----                                    | ----                                   | ----                                    | ----                                   | ----                                   | bool-expr -> bool-expr · and bool-expr | ----                                     | cmp-expr -> expr · <  expr | ----           | fun -> fun · id            | ----                                       | expr -> accessor ·            | ----                  |
  | accessor -> · id dot id                | accessor -> id · dot id   |                     |                                            |                                           | accessor -> · id dot id                    | accessor -> · id dot id                |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        | bool-expr -> bool-expr · or bool-expr  |                                          | cmp-expr -> expr · <= expr |                | fun -> fun · lit           |                                            | accessor -> accessor · dot id |                       |
  +----------------------------------------+---------------------------+---------------------+--------------------------------------------+-------------------------------------------+--------------------------------------------+----------------------------------------+----------------------------------------+-----------------------------------------+-----------------------------------------+----------------------------------------+-----------------------------------------+----------------------------------------+-----------------------------------------+----------------------------------------+----------------------------------------+----------------------------------------+------------------------------------------+----------------------------+----------------+----------------------------+--------------------------------------------+-------------------------------+-----------------------+
  |                                        |                           |                     | shift(i)                                   | shift(i)                                  |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | ----                                       | ----                                      |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | bool-expr -> bool-expr and · bool-expr     | bool-expr -> bool-expr or · bool-expr     |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | bool-expr -> · bool-expr and bool-expr     | bool-expr -> · bool-expr and bool-expr    |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | bool-expr -> · bool-expr or bool-expr      | bool-expr -> · bool-expr or bool-expr     |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | bool-expr -> · not bool-expr               | bool-expr -> · not bool-expr              |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | bool-expr -> · cmp-expr                    | bool-expr -> · cmp-expr                   |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | bool-expr -> · ( bool-expr )               | bool-expr -> · ( bool-expr )              |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | bool-expr -> · expr                        | bool-expr -> · expr                       |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | cmp-expr -> · expr == expr                 | cmp-expr -> · expr == expr                |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | cmp-expr -> · expr != expr                 | cmp-expr -> · expr != expr                |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | cmp-expr -> · expr >  expr                 | cmp-expr -> · expr >  expr                |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | cmp-expr -> · expr >= expr                 | cmp-expr -> · expr >= expr                |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | cmp-expr -> · expr <  expr                 | cmp-expr -> · expr <  expr                |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | cmp-expr -> · expr <= expr                 | cmp-expr -> · expr <= expr                |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | expr -> · call                             | expr -> · call                            |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | expr -> · accessor                         | expr -> · accessor                        |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | expr -> · lit                              | expr -> · lit                             |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | expr -> · id                               | expr -> · id                              |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | call -> · fun ( operands )                 | call -> · fun ( operands )                |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | call -> · fun ( )                          | call -> · fun ( )                         |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | fun -> · fun id                            | fun -> · fun id                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        | syntax error              | syntax error        | fun -> · fun lit                           | fun -> · fun lit                          | syntax error                               | syntax error                           | syntax error                           | syntax error                            | syntax error                            | syntax error                           | syntax error                            | syntax error                           | syntax error                            | syntax error                           | syntax error                           | syntax error                           | syntax error                             | syntax error               | syntax error   | syntax error               | syntax error                               | syntax error                  | shift(e)              |
  | guard -> bool-expr · $$                | quit                      | quit                | fun -> · id                                | fun -> · id                               | quit                                       | quit                                   | quit                                   | quit                                    | quit                                    | quit                                   | quit                                    | quit                                   | quit                                    | quit                                   | quit                                   | quit                                   | quit                                     | quit                       | quit           | quit                       | quit                                       | quit                          | reduce to guard       |
  | bool-expr -> bool-expr · and bool-expr | ----                      | ----                | accessor -> · accessor dot id              | accessor -> · accessor dot id             | ----                                       | ----                                   | ----                                   | ----                                    | ----                                    | ----                                   | ----                                    | ----                                   | ----                                    | ----                                   | ----                                   | ----                                   | ----                                     | ----                       | ----           | ----                       | ----                                       | ----                          | ----                  |
  | bool-expr -> bool-expr · or bool-expr  |                           |                     | accessor -> · id dot id                    | accessor -> · id dot id                   |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  +----------------------------------------+---------------------------+---------------------+--------------------------------------------+-------------------------------------------+--------------------------------------------+----------------------------------------+----------------------------------------+-----------------------------------------+-----------------------------------------+----------------------------------------+-----------------------------------------+----------------------------------------+-----------------------------------------+----------------------------------------+----------------------------------------+----------------------------------------+------------------------------------------+----------------------------+----------------+----------------------------+--------------------------------------------+-------------------------------+-----------------------+
  |                                        |                           |                     |                                            |                                           | shift(i)                                   | shift(d)                               |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     |                                            |                                           | ----                                       | ----                                   |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | bool-expr -> bool-expr and · bool-expr |                           |                     |                                            |                                           | bool-expr -> not · bool-expr               | bool-expr -> ( · bool-expr )           |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | bool-expr -> · bool-expr and bool-expr |                           |                     |                                            |                                           | bool-expr -> · bool-expr and bool-expr     | bool-expr -> · bool-expr and bool-expr |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | bool-expr -> · bool-expr or bool-expr  |                           |                     |                                            |                                           | bool-expr -> · bool-expr or bool-expr      | bool-expr -> · bool-expr or bool-expr  |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | bool-expr -> · not bool-expr           |                           |                     |                                            |                                           | bool-expr -> · not bool-expr               | bool-expr -> · not bool-expr           |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | bool-expr -> · cmp-expr                |                           |                     |                                            |                                           | bool-expr -> · cmp-expr                    | bool-expr -> · cmp-expr                |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | bool-expr -> · ( bool-expr )           |                           |                     |                                            |                                           | bool-expr -> · ( bool-expr )               | bool-expr -> · ( bool-expr )           |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | bool-expr -> · expr                    |                           |                     |                                            |                                           | bool-expr -> · expr                        | bool-expr -> · expr                    |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | cmp-expr -> · expr == expr             |                           |                     |                                            |                                           | cmp-expr -> · expr == expr                 | cmp-expr -> · expr == expr             |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | cmp-expr -> · expr != expr             |                           |                     |                                            |                                           | cmp-expr -> · expr != expr                 | cmp-expr -> · expr != expr             |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | cmp-expr -> · expr >  expr             |                           |                     |                                            |                                           | cmp-expr -> · expr >  expr                 | cmp-expr -> · expr >  expr             |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | cmp-expr -> · expr >= expr             |                           |                     |                                            |                                           | cmp-expr -> · expr >= expr                 | cmp-expr -> · expr >= expr             |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | cmp-expr -> · expr <  expr             |                           |                     |                                            |                                           | cmp-expr -> · expr <  expr                 | cmp-expr -> · expr <  expr             |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | cmp-expr -> · expr <= expr             |                           |                     |                                            |                                           | cmp-expr -> · expr <= expr                 | cmp-expr -> · expr <= expr             |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | expr -> · call                         |                           |                     |                                            |                                           | expr -> · call                             | expr -> · call                         |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | expr -> · accessor                     |                           |                     |                                            |                                           | expr -> · accessor                         | expr -> · accessor                     |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | expr -> · lit                          |                           |                     |                                            |                                           | expr -> · lit                              | expr -> · lit                          |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          | shift(e)                   |                |                            |                                            |                               |                       |
  | expr -> · id                           |                           |                     |                                            |                                           | expr -> · id                               | expr -> · id                           |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          | ----                       |                |                            |                                            |                               |                       |
  | call -> · fun ( operands )             |                           |                     |                                            |                                           | call -> · fun ( operands )                 | call -> · fun ( operands )             |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          | bool-expr -> expr ·        |                |                            |                                            |                               |                       |
  | call -> · fun ( )                      |                           |                     |                                            |                                           | call -> · fun ( )                          | call -> · fun ( )                      |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          | cmp-expr -> expr · == expr |                | shift(f)                   |                                            |                               |                       |
  | fun -> · fun id                        | shift(i)                  |                     |                                            |                                           | fun -> · fun id                            | fun -> · fun id                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        | shift(e)                               |                                          | cmp-expr -> expr · != expr |                | ----                       |                                            |                               |                       |
  | fun -> · fun lit                       | ----                      | shift(l)            | syntax error                               | syntax error                              | fun -> · fun lit                           | fun -> · fun lit                       | syntax error                           | syntax error                            | syntax error                            | syntax error                           | syntax error                            | syntax error                           | syntax error                            | syntax error                           | syntax error                           | ----                                   | shift(e)                                 | cmp-expr -> expr · >  expr | shift(c)       | call -> fun · ( operands ) | syntax error                               | shift(a)                      | syntax error          |
  | fun -> · id                            | expr -> id ·              | reduce to expr      | quit                                       | quit                                      | fun -> · id                                | fun -> · id                            | quit                                   | quit                                    | quit                                    | quit                                   | quit                                    | quit                                   | quit                                    | quit                                   | quit                                   | bool-expr -> bool-expr and bool-expr · | reduce 1 to bool expr                    | cmp-expr -> expr · >= expr | reduce to expr | call -> fun · ( )          | quit                                       | ----                          | quit                  |
  | accessor -> · accessor dot id          | fun -> id ·               | ----                | ----                                       | ----                                      | accessor -> · accessor dot id              | accessor -> · accessor dot id          | ----                                   | ----                                    | ----                                    | ----                                   | ----                                    | ----                                   | ----                                    | ----                                   | ----                                   | bool-expr -> bool-expr · and bool-expr | ----                                     | cmp-expr -> expr · <  expr | ----           | fun -> fun · id            | ----                                       | expr -> accessor ·            | ----                  |
  | accessor -> · id dot id                | accessor -> id · dot id   |                     |                                            |                                           | accessor -> · id dot id                    | accessor -> · id dot id                |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        | bool-expr -> bool-expr · or bool-expr  |                                          | cmp-expr -> expr · <= expr |                | fun -> fun · lit           |                                            | accessor -> accessor · dot id |                       |
  +----------------------------------------+---------------------------+---------------------+--------------------------------------------+-------------------------------------------+--------------------------------------------+----------------------------------------+----------------------------------------+-----------------------------------------+-----------------------------------------+----------------------------------------+-----------------------------------------+----------------------------------------+-----------------------------------------+----------------------------------------+----------------------------------------+----------------------------------------+------------------------------------------+----------------------------+----------------+----------------------------+--------------------------------------------+-------------------------------+-----------------------+
  |                                        |                           |                     | shift(i)                                   | shift(i)                                  |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | ----                                       | ----                                      |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | bool-expr -> bool-expr and · bool-expr     | bool-expr -> bool-expr or · bool-expr     |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | bool-expr -> · bool-expr and bool-expr     | bool-expr -> · bool-expr and bool-expr    |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | bool-expr -> · bool-expr or bool-expr      | bool-expr -> · bool-expr or bool-expr     |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | bool-expr -> · not bool-expr               | bool-expr -> · not bool-expr              |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | bool-expr -> · cmp-expr                    | bool-expr -> · cmp-expr                   |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | bool-expr -> · ( bool-expr )               | bool-expr -> · ( bool-expr )              |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | bool-expr -> · expr                        | bool-expr -> · expr                       |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | cmp-expr -> · expr == expr                 | cmp-expr -> · expr == expr                |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | cmp-expr -> · expr != expr                 | cmp-expr -> · expr != expr                |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | cmp-expr -> · expr >  expr                 | cmp-expr -> · expr >  expr                |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | cmp-expr -> · expr >= expr                 | cmp-expr -> · expr >= expr                |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | cmp-expr -> · expr <  expr                 | cmp-expr -> · expr <  expr                |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | cmp-expr -> · expr <= expr                 | cmp-expr -> · expr <= expr                |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | expr -> · call                             | expr -> · call                            |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | expr -> · accessor                         | expr -> · accessor                        |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | expr -> · lit                              | expr -> · lit                             |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | expr -> · id                               | expr -> · id                              |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | call -> · fun ( operands )                 | call -> · fun ( operands )                |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | call -> · fun ( )                          | call -> · fun ( )                         |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | fun -> · fun id                            | fun -> · fun id                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        | syntax error              | syntax error        | fun -> · fun lit                           | fun -> · fun lit                          | syntax error                               | syntax error                           | reduce 3 to bool expr                  | syntax error                            | syntax error                            | syntax error                           | syntax error                            | syntax error                           | syntax error                            | syntax error                           | syntax error                           | syntax error                           | syntax error                             | syntax error               | syntax error   | syntax error               | syntax error                               | syntax error                  | reduce 3 to bool expr |
  | bool-expr -> bool-expr and bool-expr · | quit                      | quit                | fun -> · id                                | fun -> · id                               | quit                                       | quit                                   | enqueue(d)                             | quit                                    | quit                                    | quit                                   | quit                                    | quit                                   | quit                                    | quit                                   | quit                                   | quit                                   | quit                                     | quit                       | quit           | quit                       | quit                                       | quit                          | enqueue(e)            |
  | bool-expr -> bool-expr · and bool-expr | ----                      | ----                | accessor -> · accessor dot id              | accessor -> · accessor dot id             | ----                                       | ----                                   | ----                                   | ----                                    | ----                                    | ----                                   | ----                                    | ----                                   | ----                                    | ----                                   | ----                                   | ----                                   | ----                                     | ----                       | ----           | ----                       | ----                                       | ----                          | ----                  |
  | bool-expr -> bool-expr · or bool-expr  |                           |                     | accessor -> · id dot id                    | accessor -> · id dot id                   |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  +----------------------------------------+---------------------------+---------------------+--------------------------------------------+-------------------------------------------+--------------------------------------------+----------------------------------------+----------------------------------------+-----------------------------------------+-----------------------------------------+----------------------------------------+-----------------------------------------+----------------------------------------+-----------------------------------------+----------------------------------------+----------------------------------------+----------------------------------------+------------------------------------------+----------------------------+----------------+----------------------------+--------------------------------------------+-------------------------------+-----------------------+
  |                                        |                           |                     |                                            |                                           | shift(i)                                   | shift(d)                               |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     |                                            |                                           | ----                                       | ----                                   |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | bool-expr -> bool-expr or · bool-expr  |                           |                     |                                            |                                           | bool-expr -> not · bool-expr               | bool-expr -> ( · bool-expr )           |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | bool-expr -> · bool-expr and bool-expr |                           |                     |                                            |                                           | bool-expr -> · bool-expr and bool-expr     | bool-expr -> · bool-expr and bool-expr |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | bool-expr -> · bool-expr or bool-expr  |                           |                     |                                            |                                           | bool-expr -> · bool-expr or bool-expr      | bool-expr -> · bool-expr or bool-expr  |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | bool-expr -> · not bool-expr           |                           |                     |                                            |                                           | bool-expr -> · not bool-expr               | bool-expr -> · not bool-expr           |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | bool-expr -> · cmp-expr                |                           |                     |                                            |                                           | bool-expr -> · cmp-expr                    | bool-expr -> · cmp-expr                |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | bool-expr -> · ( bool-expr )           |                           |                     |                                            |                                           | bool-expr -> · ( bool-expr )               | bool-expr -> · ( bool-expr )           |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | bool-expr -> · expr                    |                           |                     |                                            |                                           | bool-expr -> · expr                        | bool-expr -> · expr                    |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | cmp-expr -> · expr == expr             |                           |                     |                                            |                                           | cmp-expr -> · expr == expr                 | cmp-expr -> · expr == expr             |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | cmp-expr -> · expr != expr             |                           |                     |                                            |                                           | cmp-expr -> · expr != expr                 | cmp-expr -> · expr != expr             |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | cmp-expr -> · expr >  expr             |                           |                     |                                            |                                           | cmp-expr -> · expr >  expr                 | cmp-expr -> · expr >  expr             |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | cmp-expr -> · expr >= expr             |                           |                     |                                            |                                           | cmp-expr -> · expr >= expr                 | cmp-expr -> · expr >= expr             |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | cmp-expr -> · expr <  expr             |                           |                     |                                            |                                           | cmp-expr -> · expr <  expr                 | cmp-expr -> · expr <  expr             |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | cmp-expr -> · expr <= expr             |                           |                     |                                            |                                           | cmp-expr -> · expr <= expr                 | cmp-expr -> · expr <= expr             |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | expr -> · call                         |                           |                     |                                            |                                           | expr -> · call                             | expr -> · call                         |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | expr -> · accessor                     |                           |                     |                                            |                                           | expr -> · accessor                         | expr -> · accessor                     |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | expr -> · lit                          |                           |                     |                                            |                                           | expr -> · lit                              | expr -> · lit                          |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          | shift(e)                   |                |                            |                                            |                               |                       |
  | expr -> · id                           |                           |                     |                                            |                                           | expr -> · id                               | expr -> · id                           |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          | ----                       |                |                            |                                            |                               |                       |
  | call -> · fun ( operands )             |                           |                     |                                            |                                           | call -> · fun ( operands )                 | call -> · fun ( operands )             |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          | bool-expr -> expr ·        |                |                            |                                            |                               |                       |
  | call -> · fun ( )                      |                           |                     |                                            |                                           | call -> · fun ( )                          | call -> · fun ( )                      |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          | cmp-expr -> expr · == expr |                | shift(f)                   |                                            |                               |                       |
  | fun -> · fun id                        | shift(i)                  |                     |                                            |                                           | fun -> · fun id                            | fun -> · fun id                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        | shift(e)                               |                                          | cmp-expr -> expr · != expr |                | ----                       |                                            |                               |                       |
  | fun -> · fun lit                       | ----                      | shift(l)            | syntax error                               | syntax error                              | fun -> · fun lit                           | fun -> · fun lit                       | syntax error                           | syntax error                            | syntax error                            | syntax error                           | syntax error                            | syntax error                           | syntax error                            | syntax error                           | syntax error                           | ----                                   | shift(e)                                 | cmp-expr -> expr · >  expr | shift(c)       | call -> fun · ( operands ) | syntax error                               | shift(a)                      | syntax error          |
  | fun -> · id                            | expr -> id ·              | reduce to expr      | quit                                       | quit                                      | fun -> · id                                | fun -> · id                            | quit                                   | quit                                    | quit                                    | quit                                   | quit                                    | quit                                   | quit                                    | quit                                   | quit                                   | bool-expr -> bool-expr or bool-expr ·  | reduce 1 to bool expr                    | cmp-expr -> expr · >= expr | reduce to expr | call -> fun · ( )          | quit                                       | ----                          | quit                  |
  | accessor -> · accessor dot id          | fun -> id ·               | ----                | ----                                       | ----                                      | accessor -> · accessor dot id              | accessor -> · accessor dot id          | ----                                   | ----                                    | ----                                    | ----                                   | ----                                    | ----                                   | ----                                    | ----                                   | ----                                   | bool-expr -> bool-expr · and bool-expr | ----                                     | cmp-expr -> expr · <  expr | ----           | fun -> fun · id            | ----                                       | expr -> accessor ·            | ----                  |
  | accessor -> · id dot id                | accessor -> id · dot id   |                     |                                            |                                           | accessor -> · id dot id                    | accessor -> · id dot id                |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        | bool-expr -> bool-expr · or bool-expr  |                                          | cmp-expr -> expr · <= expr |                | fun -> fun · lit           |                                            | accessor -> accessor · dot id |                       |
  +----------------------------------------+---------------------------+---------------------+--------------------------------------------+-------------------------------------------+--------------------------------------------+----------------------------------------+----------------------------------------+-----------------------------------------+-----------------------------------------+----------------------------------------+-----------------------------------------+----------------------------------------+-----------------------------------------+----------------------------------------+----------------------------------------+----------------------------------------+------------------------------------------+----------------------------+----------------+----------------------------+--------------------------------------------+-------------------------------+-----------------------+
  |                                        |                           |                     | shift(i)                                   | shift(i)                                  |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | ----                                       | ----                                      |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | bool-expr -> bool-expr and · bool-expr     | bool-expr -> bool-expr or · bool-expr     |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | bool-expr -> · bool-expr and bool-expr     | bool-expr -> · bool-expr and bool-expr    |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | bool-expr -> · bool-expr or bool-expr      | bool-expr -> · bool-expr or bool-expr     |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | bool-expr -> · not bool-expr               | bool-expr -> · not bool-expr              |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | bool-expr -> · cmp-expr                    | bool-expr -> · cmp-expr                   |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | bool-expr -> · ( bool-expr )               | bool-expr -> · ( bool-expr )              |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | bool-expr -> · expr                        | bool-expr -> · expr                       |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | cmp-expr -> · expr == expr                 | cmp-expr -> · expr == expr                |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | cmp-expr -> · expr != expr                 | cmp-expr -> · expr != expr                |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | cmp-expr -> · expr >  expr                 | cmp-expr -> · expr >  expr                |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | cmp-expr -> · expr >= expr                 | cmp-expr -> · expr >= expr                |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | cmp-expr -> · expr <  expr                 | cmp-expr -> · expr <  expr                |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | cmp-expr -> · expr <= expr                 | cmp-expr -> · expr <= expr                |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | expr -> · call                             | expr -> · call                            |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | expr -> · accessor                         | expr -> · accessor                        |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | expr -> · lit                              | expr -> · lit                             |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | expr -> · id                               | expr -> · id                              |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | call -> · fun ( operands )                 | call -> · fun ( operands )                |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | call -> · fun ( )                          | call -> · fun ( )                         |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | fun -> · fun id                            | fun -> · fun id                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        | syntax error              | syntax error        | fun -> · fun lit                           | fun -> · fun lit                          | syntax error                               | syntax error                           | reduce 3 to bool expr                  | syntax error                            | syntax error                            | syntax error                           | syntax error                            | syntax error                           | syntax error                            | syntax error                           | syntax error                           | syntax error                           | syntax error                             | syntax error               | syntax error   | syntax error               | syntax error                               | syntax error                  | reduce 3 to bool expr |
  | bool-expr -> bool-expr or bool-expr ·  | quit                      | quit                | fun -> · id                                | fun -> · id                               | quit                                       | quit                                   | enqueue(d)                             | quit                                    | quit                                    | quit                                   | quit                                    | quit                                   | quit                                    | quit                                   | quit                                   | quit                                   | quit                                     | quit                       | quit           | quit                       | quit                                       | quit                          | enqueue(e)            |
  | bool-expr -> bool-expr · and bool-expr | ----                      | ----                | accessor -> · accessor dot id              | accessor -> · accessor dot id             | ----                                       | ----                                   | ----                                   | ----                                    | ----                                    | ----                                   | ----                                    | ----                                   | ----                                    | ----                                   | ----                                   | ----                                   | ----                                     | ----                       | ----           | ----                       | ----                                       | ----                          | ----                  |
  | bool-expr -> bool-expr · or bool-expr  |                           |                     | accessor -> · id dot id                    | accessor -> · id dot id                   |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  +----------------------------------------+---------------------------+---------------------+--------------------------------------------+-------------------------------------------+--------------------------------------------+----------------------------------------+----------------------------------------+-----------------------------------------+-----------------------------------------+----------------------------------------+-----------------------------------------+----------------------------------------+-----------------------------------------+----------------------------------------+----------------------------------------+----------------------------------------+------------------------------------------+----------------------------+----------------+----------------------------+--------------------------------------------+-------------------------------+-----------------------+
  |                                        |                           |                     |                                            |                                           |                                            | shift(d)                               |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     |                                            |                                           |                                            | ----                                   |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | bool-expr -> not · bool-expr           |                           |                     |                                            |                                           |                                            | bool-expr -> ( · bool-expr )           |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | bool-expr -> · bool-expr and bool-expr |                           |                     |                                            |                                           |                                            | bool-expr -> · bool-expr and bool-expr |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | bool-expr -> · bool-expr or bool-expr  |                           |                     |                                            |                                           |                                            | bool-expr -> · bool-expr or bool-expr  |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | bool-expr -> · not bool-expr           |                           |                     |                                            |                                           |                                            | bool-expr -> · not bool-expr           |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | bool-expr -> · cmp-expr                |                           |                     |                                            |                                           |                                            | bool-expr -> · cmp-expr                |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | bool-expr -> · ( bool-expr )           |                           |                     |                                            |                                           |                                            | bool-expr -> · ( bool-expr )           |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | bool-expr -> · expr                    |                           |                     |                                            |                                           |                                            | bool-expr -> · expr                    |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | cmp-expr -> · expr == expr             |                           |                     |                                            |                                           |                                            | cmp-expr -> · expr == expr             |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | cmp-expr -> · expr != expr             |                           |                     |                                            |                                           |                                            | cmp-expr -> · expr != expr             |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | cmp-expr -> · expr >  expr             |                           |                     |                                            |                                           |                                            | cmp-expr -> · expr >  expr             |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | cmp-expr -> · expr >= expr             |                           |                     |                                            |                                           |                                            | cmp-expr -> · expr >= expr             |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | cmp-expr -> · expr <  expr             |                           |                     |                                            |                                           |                                            | cmp-expr -> · expr <  expr             |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | cmp-expr -> · expr <= expr             |                           |                     |                                            |                                           |                                            | cmp-expr -> · expr <= expr             |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | expr -> · call                         |                           |                     |                                            |                                           |                                            | expr -> · call                         |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | expr -> · accessor                     |                           |                     |                                            |                                           |                                            | expr -> · accessor                     |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | expr -> · lit                          |                           |                     |                                            |                                           |                                            | expr -> · lit                          |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          | shift(e)                   |                |                            |                                            |                               |                       |
  | expr -> · id                           |                           |                     |                                            |                                           |                                            | expr -> · id                           |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          | ----                       |                |                            |                                            |                               |                       |
  | call -> · fun ( operands )             |                           |                     |                                            |                                           |                                            | call -> · fun ( operands )             |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          | bool-expr -> expr ·        |                |                            |                                            |                               |                       |
  | call -> · fun ( )                      |                           |                     |                                            |                                           |                                            | call -> · fun ( )                      |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          | cmp-expr -> expr · == expr |                | shift(f)                   |                                            |                               |                       |
  | fun -> · fun id                        | shift(i)                  |                     |                                            |                                           |                                            | fun -> · fun id                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        | shift(e)                               |                                          | cmp-expr -> expr · != expr |                | ----                       |                                            |                               |                       |
  | fun -> · fun lit                       | ----                      | shift(l)            | syntax error                               | syntax error                              |                                            | fun -> · fun lit                       | syntax error                           | syntax error                            | syntax error                            | syntax error                           | syntax error                            | syntax error                           | syntax error                            | syntax error                           | syntax error                           | ----                                   | shift(e)                                 | cmp-expr -> expr · >  expr | shift(c)       | call -> fun · ( operands ) | syntax error                               | shift(a)                      | syntax error          |
  | fun -> · id                            | expr -> id ·              | reduce to expr      | quit                                       | quit                                      | shift(i)                                   | fun -> · id                            | quit                                   | quit                                    | quit                                    | quit                                   | quit                                    | quit                                   | quit                                    | quit                                   | quit                                   | bool-expr -> not bool-expr ·           | reduce 1 to bool expr                    | cmp-expr -> expr · >= expr | reduce to expr | call -> fun · ( )          | quit                                       | ----                          | quit                  |
  | accessor -> · accessor dot id          | fun -> id ·               | ----                | ----                                       | ----                                      | ----                                       | accessor -> · accessor dot id          | ----                                   | ----                                    | ----                                    | ----                                   | ----                                    | ----                                   | ----                                    | ----                                   | ----                                   | bool-expr -> bool-expr · and bool-expr | ----                                     | cmp-expr -> expr · <  expr | ----           | fun -> fun · id            | ----                                       | expr -> accessor ·            | ----                  |
  | accessor -> · id dot id                | accessor -> id · dot id   |                     |                                            |                                           |                                            | accessor -> · id dot id                |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        | bool-expr -> bool-expr · or bool-expr  |                                          | cmp-expr -> expr · <= expr |                | fun -> fun · lit           |                                            | accessor -> accessor · dot id |                       |
  +----------------------------------------+---------------------------+---------------------+--------------------------------------------+-------------------------------------------+--------------------------------------------+----------------------------------------+----------------------------------------+-----------------------------------------+-----------------------------------------+----------------------------------------+-----------------------------------------+----------------------------------------+-----------------------------------------+----------------------------------------+----------------------------------------+----------------------------------------+------------------------------------------+----------------------------+----------------+----------------------------+--------------------------------------------+-------------------------------+-----------------------+
  |                                        |                           |                     | shift(i)                                   | shift(i)                                  |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | ----                                       | ----                                      |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | bool-expr -> bool-expr and · bool-expr     | bool-expr -> bool-expr or · bool-expr     |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | bool-expr -> · bool-expr and bool-expr     | bool-expr -> · bool-expr and bool-expr    |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | bool-expr -> · bool-expr or bool-expr      | bool-expr -> · bool-expr or bool-expr     |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | bool-expr -> · not bool-expr               | bool-expr -> · not bool-expr              |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | bool-expr -> · cmp-expr                    | bool-expr -> · cmp-expr                   |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | bool-expr -> · ( bool-expr )               | bool-expr -> · ( bool-expr )              |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | bool-expr -> · expr                        | bool-expr -> · expr                       |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | cmp-expr -> · expr == expr                 | cmp-expr -> · expr == expr                |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | cmp-expr -> · expr != expr                 | cmp-expr -> · expr != expr                |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | cmp-expr -> · expr >  expr                 | cmp-expr -> · expr >  expr                |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | cmp-expr -> · expr >= expr                 | cmp-expr -> · expr >= expr                |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | cmp-expr -> · expr <  expr                 | cmp-expr -> · expr <  expr                |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | cmp-expr -> · expr <= expr                 | cmp-expr -> · expr <= expr                |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | expr -> · call                             | expr -> · call                            |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | expr -> · accessor                         | expr -> · accessor                        |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | expr -> · lit                              | expr -> · lit                             |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | expr -> · id                               | expr -> · id                              |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | call -> · fun ( operands )                 | call -> · fun ( operands )                |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | call -> · fun ( )                          | call -> · fun ( )                         |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | fun -> · fun id                            | fun -> · fun id                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        | syntax error              | syntax error        | fun -> · fun lit                           | fun -> · fun lit                          | syntax error                               | syntax error                           | reduce 2 to bool expr                  | syntax error                            | syntax error                            | syntax error                           | syntax error                            | syntax error                           | syntax error                            | syntax error                           | syntax error                           | syntax error                           | syntax error                             | syntax error               | syntax error   | syntax error               | syntax error                               | syntax error                  | reduce 2 to bool expr |
  | bool-expr -> not bool-expr ·           | quit                      | quit                | fun -> · id                                | fun -> · id                               | quit                                       | quit                                   | enqueue(d)                             | quit                                    | quit                                    | quit                                   | quit                                    | quit                                   | quit                                    | quit                                   | quit                                   | quit                                   | quit                                     | quit                       | quit           | quit                       | quit                                       | quit                          | enqueue(e)            |
  | bool-expr -> bool-expr · and bool-expr | ----                      | ----                | accessor -> · accessor dot id              | accessor -> · accessor dot id             | ----                                       | ----                                   | ----                                   | ----                                    | ----                                    | ----                                   | ----                                    | ----                                   | ----                                    | ----                                   | ----                                   | ----                                   | ----                                     | ----                       | ----           | ----                       | ----                                       | ----                          | ----                  |
  | bool-expr -> bool-expr · or bool-expr  |                           |                     | accessor -> · id dot id                    | accessor -> · id dot id                   |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  +----------------------------------------+---------------------------+---------------------+--------------------------------------------+-------------------------------------------+--------------------------------------------+----------------------------------------+----------------------------------------+-----------------------------------------+-----------------------------------------+----------------------------------------+-----------------------------------------+----------------------------------------+-----------------------------------------+----------------------------------------+----------------------------------------+----------------------------------------+------------------------------------------+----------------------------+----------------+----------------------------+--------------------------------------------+-------------------------------+-----------------------+
  |                                        |                           |                     |                                            |                                           | shift(i)                                   |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     |                                            |                                           | ----                                       |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | bool-expr -> ( · bool-expr )           |                           |                     |                                            |                                           | bool-expr -> not · bool-expr               |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | bool-expr -> · bool-expr and bool-expr |                           |                     |                                            |                                           | bool-expr -> · bool-expr and bool-expr     |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | bool-expr -> · bool-expr or bool-expr  |                           |                     |                                            |                                           | bool-expr -> · bool-expr or bool-expr      |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | bool-expr -> · not bool-expr           |                           |                     |                                            |                                           | bool-expr -> · not bool-expr               |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | bool-expr -> · cmp-expr                |                           |                     |                                            |                                           | bool-expr -> · cmp-expr                    |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | bool-expr -> · ( bool-expr )           |                           |                     |                                            |                                           | bool-expr -> · ( bool-expr )               |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | bool-expr -> · expr                    |                           |                     |                                            |                                           | bool-expr -> · expr                        |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | cmp-expr -> · expr == expr             |                           |                     |                                            |                                           | cmp-expr -> · expr == expr                 |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | cmp-expr -> · expr != expr             |                           |                     |                                            |                                           | cmp-expr -> · expr != expr                 |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | cmp-expr -> · expr >  expr             |                           |                     |                                            |                                           | cmp-expr -> · expr >  expr                 |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | cmp-expr -> · expr >= expr             |                           |                     |                                            |                                           | cmp-expr -> · expr >= expr                 |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | cmp-expr -> · expr <  expr             |                           |                     |                                            |                                           | cmp-expr -> · expr <  expr                 |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | cmp-expr -> · expr <= expr             |                           |                     |                                            |                                           | cmp-expr -> · expr <= expr                 |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | expr -> · call                         |                           |                     |                                            |                                           | expr -> · call                             |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | expr -> · accessor                     |                           |                     |                                            |                                           | expr -> · accessor                         |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | expr -> · lit                          |                           |                     |                                            |                                           | expr -> · lit                              |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          | shift(e)                   |                |                            |                                            |                               |                       |
  | expr -> · id                           |                           |                     |                                            |                                           | expr -> · id                               |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          | ----                       |                |                            |                                            |                               |                       |
  | call -> · fun ( operands )             |                           |                     |                                            |                                           | call -> · fun ( operands )                 |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          | bool-expr -> expr ·        |                |                            |                                            |                               |                       |
  | call -> · fun ( )                      |                           |                     |                                            |                                           | call -> · fun ( )                          |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          | cmp-expr -> expr · == expr |                | shift(f)                   |                                            |                               |                       |
  | fun -> · fun id                        | shift(i)                  |                     |                                            |                                           | fun -> · fun id                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        | shift(e)                               |                                          | cmp-expr -> expr · != expr |                | ----                       |                                            |                               |                       |
  | fun -> · fun lit                       | ----                      | shift(l)            | syntax error                               | syntax error                              | fun -> · fun lit                           |                                        | syntax error                           | syntax error                            | syntax error                            | syntax error                           | syntax error                            | syntax error                           | syntax error                            | syntax error                           | syntax error                           | ----                                   | shift(e)                                 | cmp-expr -> expr · >  expr | shift(c)       | call -> fun · ( operands ) | syntax error                               | shift(a)                      | syntax error          |
  | fun -> · id                            | expr -> id ·              | reduce to expr      | quit                                       | quit                                      | fun -> · id                                | shift(d)                               | quit                                   | quit                                    | quit                                    | quit                                   | quit                                    | quit                                   | quit                                    | quit                                   | quit                                   | bool-expr -> ( bool-expr · )           | reduce 1 to bool expr                    | cmp-expr -> expr · >= expr | reduce to expr | call -> fun · ( )          | quit                                       | ----                          | quit                  |
  | accessor -> · accessor dot id          | fun -> id ·               | ----                | ----                                       | ----                                      | accessor -> · accessor dot id              | ----                                   | ----                                   | ----                                    | ----                                    | ----                                   | ----                                    | ----                                   | ----                                    | ----                                   | ----                                   | bool-expr -> bool-expr · and bool-expr | ----                                     | cmp-expr -> expr · <  expr | ----           | fun -> fun · id            | ----                                       | expr -> accessor ·            | ----                  |
  | accessor -> · id dot id                | accessor -> id · dot id   |                     |                                            |                                           | accessor -> · id dot id                    |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        | bool-expr -> bool-expr · or bool-expr  |                                          | cmp-expr -> expr · <= expr |                | fun -> fun · lit           |                                            | accessor -> accessor · dot id |                       |
  +----------------------------------------+---------------------------+---------------------+--------------------------------------------+-------------------------------------------+--------------------------------------------+----------------------------------------+----------------------------------------+-----------------------------------------+-----------------------------------------+----------------------------------------+-----------------------------------------+----------------------------------------+-----------------------------------------+----------------------------------------+----------------------------------------+----------------------------------------+------------------------------------------+----------------------------+----------------+----------------------------+--------------------------------------------+-------------------------------+-----------------------+
  |                                        |                           |                     | shift(i)                                   | shift(i)                                  |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | ----                                       | ----                                      |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | bool-expr -> bool-expr and · bool-expr     | bool-expr -> bool-expr or · bool-expr     |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | bool-expr -> · bool-expr and bool-expr     | bool-expr -> · bool-expr and bool-expr    |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | bool-expr -> · bool-expr or bool-expr      | bool-expr -> · bool-expr or bool-expr     |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | bool-expr -> · not bool-expr               | bool-expr -> · not bool-expr              |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | bool-expr -> · cmp-expr                    | bool-expr -> · cmp-expr                   |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | bool-expr -> · ( bool-expr )               | bool-expr -> · ( bool-expr )              |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | bool-expr -> · expr                        | bool-expr -> · expr                       |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | cmp-expr -> · expr == expr                 | cmp-expr -> · expr == expr                |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | cmp-expr -> · expr != expr                 | cmp-expr -> · expr != expr                |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | cmp-expr -> · expr >  expr                 | cmp-expr -> · expr >  expr                |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | cmp-expr -> · expr >= expr                 | cmp-expr -> · expr >= expr                |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | cmp-expr -> · expr <  expr                 | cmp-expr -> · expr <  expr                |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | cmp-expr -> · expr <= expr                 | cmp-expr -> · expr <= expr                |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | expr -> · call                             | expr -> · call                            |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | expr -> · accessor                         | expr -> · accessor                        |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | expr -> · lit                              | expr -> · lit                             |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | expr -> · id                               | expr -> · id                              |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | call -> · fun ( operands )                 | call -> · fun ( operands )                |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | call -> · fun ( )                          | call -> · fun ( )                         |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     | fun -> · fun id                            | fun -> · fun id                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        | syntax error              | syntax error        | fun -> · fun lit                           | fun -> · fun lit                          | syntax error                               | syntax error                           | shift(d)                               | syntax error                            | syntax error                            | syntax error                           | syntax error                            | syntax error                           | syntax error                            | syntax error                           | syntax error                           | syntax error                           | syntax error                             | syntax error               | syntax error   | syntax error               | syntax error                               | syntax error                  | syntax error          |
  | bool-expr -> ( bool-expr · )           | quit                      | quit                | fun -> · id                                | fun -> · id                               | quit                                       | quit                                   | reduce 3 to bool expr                  | quit                                    | quit                                    | quit                                   | quit                                    | quit                                   | quit                                    | quit                                   | quit                                   | quit                                   | quit                                     | quit                       | quit           | quit                       | quit                                       | quit                          | quit                  |
  | bool-expr -> bool-expr · and bool-expr | ----                      | ----                | accessor -> · accessor dot id              | accessor -> · accessor dot id             | ----                                       | ----                                   | ----                                   | ----                                    | ----                                    | ----                                   | ----                                    | ----                                   | ----                                    | ----                                   | ----                                   | ----                                   | ----                                     | ----                       | ----           | ----                       | ----                                       | ----                          | ----                  |
  | bool-expr -> bool-expr · or bool-expr  |                           |                     | accessor -> · id dot id                    | accessor -> · id dot id                   |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  +----------------------------------------+---------------------------+---------------------+--------------------------------------------+-------------------------------------------+--------------------------------------------+----------------------------------------+----------------------------------------+-----------------------------------------+-----------------------------------------+----------------------------------------+-----------------------------------------+----------------------------------------+-----------------------------------------+----------------------------------------+----------------------------------------+----------------------------------------+------------------------------------------+----------------------------+----------------+----------------------------+--------------------------------------------+-------------------------------+-----------------------+
  |                                        |                           |                     |                                            |                                           |                                            |                                        |                                        | shift(d)                                | shift(d)                                | shift(d)                               | shift(d)                                | shift(d)                               | shift(d)                                |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     |                                            |                                           |                                            |                                        |                                        | ----                                    | ----                                    | ----                                   | ----                                    | ----                                   | ----                                    |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     |                                            |                                           |                                            |                                        |                                        | cmp-expr -> expr == · expr              | cmp-expr -> expr != · expr              | cmp-expr -> expr >  · expr             | cmp-expr -> expr >= · expr              | cmp-expr -> expr <  · expr             | cmp-expr -> expr <= · expr              |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     |                                            |                                           |                                            |                                        |                                        | expr -> · call                          | expr -> · call                          | expr -> · call                         | expr -> · call                          | expr -> · call                         | expr -> · call                          |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     |                                            |                                           |                                            |                                        |                                        | expr -> · accessor                      | expr -> · accessor                      | expr -> · accessor                     | expr -> · accessor                      | expr -> · accessor                     | expr -> · accessor                      |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     |                                            |                                           |                                            |                                        |                                        | expr -> · lit                           | expr -> · lit                           | expr -> · lit                          | expr -> · lit                           | expr -> · lit                          | expr -> · lit                           |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     |                                            |                                           |                                            |                                        |                                        | expr -> · id                            | expr -> · id                            | expr -> · id                           | expr -> · id                            | expr -> · id                           | expr -> · id                            |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | bool-expr -> expr ·                    |                           |                     |                                            |                                           |                                            |                                        |                                        | call -> · fun ( operands )              | call -> · fun ( operands )              | call -> · fun ( operands )             | call -> · fun ( operands )              | call -> · fun ( operands )             | call -> · fun ( operands )              |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | cmp-expr -> expr · == expr             |                           |                     |                                            |                                           |                                            |                                        |                                        | call -> · fun ( )                       | call -> · fun ( )                       | call -> · fun ( )                      | call -> · fun ( )                       | call -> · fun ( )                      | call -> · fun ( )                       |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | cmp-expr -> expr · != expr             |                           |                     |                                            |                                           |                                            |                                        |                                        | fun -> · fun id                         | fun -> · fun id                         | fun ->  · fun id                       | fun -> · fun id                         | fun -> · fun id                        | fun -> · fun id                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | cmp-expr -> expr · >  expr             | syntax error              | syntax error        | syntax error                               | syntax error                              | syntax error                               | syntax error                           | reduce 1 to bool expr                  | fun -> · fun lit                        | fun -> · fun lit                        | fun -> · fun lit                       | fun -> · fun lit                        | fun -> · fun lit                       | fun -> · fun lit                        | syntax error                           | syntax error                           | syntax error                           | syntax error                             | syntax error               | syntax error   | syntax error               | syntax error                               | syntax error                  | reduce 1 to bool expr |
  | cmp-expr -> expr · >= expr             | quit                      | quit                | quit                                       | quit                                      | quit                                       | quit                                   | enqueue(d)                             | fun -> · id                             | fun -> · id                             | fun -> · id                            | fun -> · id                             | fun -> · id                            | fun -> · id                             | quit                                   | quit                                   | quit                                   | quit                                     | quit                       | quit           | quit                       | quit                                       | quit                          | enqueue(e)            |
  | cmp-expr -> expr · <  expr             | ----                      | ----                | ----                                       | ----                                      | ----                                       | ----                                   | ----                                   | accessor -> · accessor dot id           | accessor -> · accessor dot id           | accessor -> · accessor dot id          | accessor -> · accessor dot id           | accessor -> · accessor dot id          | accessor -> · accessor dot id           | ----                                   | ----                                   | ----                                   | ----                                     | ----                       | ----           | ----                       | ----                                       | ----                          | ----                  |
  | cmp-expr -> expr · <= expr             |                           |                     |                                            |                                           |                                            |                                        |                                        | accessor -> · id dot id                 | accessor -> · id dot id                 | accessor -> · id dot id                | accessor -> · id dot id                 | accessor -> · id dot id                | accessor -> · id dot id                 |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  +----------------------------------------+---------------------------+---------------------+--------------------------------------------+-------------------------------------------+--------------------------------------------+----------------------------------------+----------------------------------------+-----------------------------------------+-----------------------------------------+----------------------------------------+-----------------------------------------+----------------------------------------+-----------------------------------------+----------------------------------------+----------------------------------------+----------------------------------------+------------------------------------------+----------------------------+----------------+----------------------------+--------------------------------------------+-------------------------------+-----------------------+
  | cmp-expr -> expr == · expr             |                           |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | expr -> · call                         |                           |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | expr -> · accessor                     |                           |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | expr -> · lit                          |                           |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | expr -> · id                           |                           |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | call -> · fun ( operands )             |                           |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | call -> · fun ( )                      |                           |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                | shift(f)                   |                                            |                               |                       |
  | fun -> · fun id                        | shift(i)                  |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                | ----                       |                                            |                               |                       |
  | fun -> · fun lit                       | ----                      | shift(l)            | syntax error                               | syntax error                              | syntax error                               | syntax error                           | syntax error                           | syntax error                            | syntax error                            | syntax error                           | syntax error                            | syntax error                           | syntax error                            | syntax error                           | syntax error                           | syntax error                           | syntax error                             | shift(e)                   | shift(c)       | call -> fun · ( operands ) | syntax error                               | shift(a)                      | syntax error          |
  | fun -> · id                            | expr -> id ·              | reduce to expr      | quit                                       | quit                                      | quit                                       | quit                                   | quit                                   | quit                                    | quit                                    | quit                                   | quit                                    | quit                                   | quit                                    | quit                                   | quit                                   | quit                                   | quit                                     | reduce 3 to cmp expr       | reduce to expr | call -> fun · ( )          | quit                                       | ----                          | quit                  |
  | accessor -> · accessor dot id          | fun -> id ·               | ----                | ----                                       | ----                                      | ----                                       | ----                                   | ----                                   | ----                                    | ----                                    | ----                                   | ----                                    | ----                                   | ----                                    | ----                                   | ----                                   | ----                                   | ----                                     | ----                       | ----           | fun -> fun · id            | ----                                       | expr -> accessor ·            | ----                  |
  | accessor -> · id dot id                | accessor -> id · dot id   |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                | fun -> fun · lit           |                                            | accessor -> accessor · dot id |                       |
  +----------------------------------------+---------------------------+---------------------+--------------------------------------------+-------------------------------------------+--------------------------------------------+----------------------------------------+----------------------------------------+-----------------------------------------+-----------------------------------------+----------------------------------------+-----------------------------------------+----------------------------------------+-----------------------------------------+----------------------------------------+----------------------------------------+----------------------------------------+------------------------------------------+----------------------------+----------------+----------------------------+--------------------------------------------+-------------------------------+-----------------------+
  | cmp-expr -> expr != · expr             |                           |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | expr -> · call                         |                           |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | expr -> · accessor                     |                           |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | expr -> · lit                          |                           |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | expr -> · id                           |                           |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | call -> · fun ( operands )             |                           |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | call -> · fun ( )                      |                           |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                | shift(f)                   |                                            |                               |                       |
  | fun -> · fun id                        | shift(i)                  |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                | ----                       |                                            |                               |                       |
  | fun -> · fun lit                       | ----                      | shift(l)            | syntax error                               | syntax error                              | syntax error                               | syntax error                           | syntax error                           | syntax error                            | syntax error                            | syntax error                           | syntax error                            | syntax error                           | syntax error                            | syntax error                           | syntax error                           | syntax error                           | syntax error                             | shift(e)                   | shift(c)       | call -> fun · ( operands ) | syntax error                               | shift(a)                      | syntax error          |
  | fun -> · id                            | expr -> id ·              | reduce to expr      | quit                                       | quit                                      | quit                                       | quit                                   | quit                                   | quit                                    | quit                                    | quit                                   | quit                                    | quit                                   | quit                                    | quit                                   | quit                                   | quit                                   | quit                                     | reduce 3 to cmp expr       | reduce to expr | call -> fun · ( )          | quit                                       | ----                          | quit                  |
  | accessor -> · accessor dot id          | fun -> id ·               | ----                | ----                                       | ----                                      | ----                                       | ----                                   | ----                                   | ----                                    | ----                                    | ----                                   | ----                                    | ----                                   | ----                                    | ----                                   | ----                                   | ----                                   | ----                                     | ----                       | ----           | fun -> fun · id            | ----                                       | expr -> accessor ·            | ----                  |
  | accessor -> · id dot id                | accessor -> id · dot id   |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                | fun -> fun · lit           |                                            | accessor -> accessor · dot id |                       |
  +----------------------------------------+---------------------------+---------------------+--------------------------------------------+-------------------------------------------+--------------------------------------------+----------------------------------------+----------------------------------------+-----------------------------------------+-----------------------------------------+----------------------------------------+-----------------------------------------+----------------------------------------+-----------------------------------------+----------------------------------------+----------------------------------------+----------------------------------------+------------------------------------------+----------------------------+----------------+----------------------------+--------------------------------------------+-------------------------------+-----------------------+
  | cmp-expr -> expr <  · expr             |                           |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | expr -> · call                         |                           |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | expr -> · accessor                     |                           |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | expr -> · lit                          |                           |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | expr -> · id                           |                           |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | call -> · fun ( operands )             |                           |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | call -> · fun ( )                      |                           |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                | shift(f)                   |                                            |                               |                       |
  | fun -> · fun id                        | shift(i)                  |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                | ----                       |                                            |                               |                       |
  | fun -> · fun lit                       | ----                      | shift(l)            | syntax error                               | syntax error                              | syntax error                               | syntax error                           | syntax error                           | syntax error                            | syntax error                            | syntax error                           | syntax error                            | syntax error                           | syntax error                            | syntax error                           | syntax error                           | syntax error                           | syntax error                             | shift(e)                   | shift(c)       | call -> fun · ( operands ) | syntax error                               | shift(a)                      | syntax error          |
  | fun -> · id                            | expr -> id ·              | reduce to expr      | quit                                       | quit                                      | quit                                       | quit                                   | quit                                   | quit                                    | quit                                    | quit                                   | quit                                    | quit                                   | quit                                    | quit                                   | quit                                   | quit                                   | quit                                     | reduce 3 to cmp expr       | reduce to expr | call -> fun · ( )          | quit                                       | ----                          | quit                  |
  | accessor -> · accessor dot id          | fun -> id ·               | ----                | ----                                       | ----                                      | ----                                       | ----                                   | ----                                   | ----                                    | ----                                    | ----                                   | ----                                    | ----                                   | ----                                    | ----                                   | ----                                   | ----                                   | ----                                     | ----                       | ----           | fun -> fun · id            | ----                                       | expr -> accessor ·            | ----                  |
  | accessor -> · id dot id                | accessor -> id · dot id   |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                | fun -> fun · lit           |                                            | accessor -> accessor · dot id |                       |
  +----------------------------------------+---------------------------+---------------------+--------------------------------------------+-------------------------------------------+--------------------------------------------+----------------------------------------+----------------------------------------+-----------------------------------------+-----------------------------------------+----------------------------------------+-----------------------------------------+----------------------------------------+-----------------------------------------+----------------------------------------+----------------------------------------+----------------------------------------+------------------------------------------+----------------------------+----------------+----------------------------+--------------------------------------------+-------------------------------+-----------------------+
  | cmp-expr -> expr <= · expr             |                           |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | expr -> · call                         |                           |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | expr -> · accessor                     |                           |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | expr -> · lit                          |                           |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | expr -> · id                           |                           |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | call -> · fun ( operands )             |                           |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | call -> · fun ( )                      |                           |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                | shift(f)                   |                                            |                               |                       |
  | fun -> · fun id                        | shift(i)                  |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                | ----                       |                                            |                               |                       |
  | fun -> · fun lit                       | ----                      | shift(l)            | syntax error                               | syntax error                              | syntax error                               | syntax error                           | syntax error                           | syntax error                            | syntax error                            | syntax error                           | syntax error                            | syntax error                           | syntax error                            | syntax error                           | syntax error                           | syntax error                           | syntax error                             | shift(e)                   | shift(c)       | call -> fun · ( operands ) | syntax error                               | shift(a)                      | syntax error          |
  | fun -> · id                            | expr -> id ·              | reduce to expr      | quit                                       | quit                                      | quit                                       | quit                                   | quit                                   | quit                                    | quit                                    | quit                                   | quit                                    | quit                                   | quit                                    | quit                                   | quit                                   | quit                                   | quit                                     | reduce 3 to cmp expr       | reduce to expr | call -> fun · ( )          | quit                                       | ----                          | quit                  |
  | accessor -> · accessor dot id          | fun -> id ·               | ----                | ----                                       | ----                                      | ----                                       | ----                                   | ----                                   | ----                                    | ----                                    | ----                                   | ----                                    | ----                                   | ----                                    | ----                                   | ----                                   | ----                                   | ----                                     | ----                       | ----           | fun -> fun · id            | ----                                       | expr -> accessor ·            | ----                  |
  | accessor -> · id dot id                | accessor -> id · dot id   |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                | fun -> fun · lit           |                                            | accessor -> accessor · dot id |                       |
  +----------------------------------------+---------------------------+---------------------+--------------------------------------------+-------------------------------------------+--------------------------------------------+----------------------------------------+----------------------------------------+-----------------------------------------+-----------------------------------------+----------------------------------------+-----------------------------------------+----------------------------------------+-----------------------------------------+----------------------------------------+----------------------------------------+----------------------------------------+------------------------------------------+----------------------------+----------------+----------------------------+--------------------------------------------+-------------------------------+-----------------------+
  | cmp-expr -> expr >  · expr             |                           |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | expr -> · call                         |                           |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | expr -> · accessor                     |                           |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | expr -> · lit                          |                           |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | expr -> · id                           |                           |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | call -> · fun ( operands )             |                           |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | call -> · fun ( )                      |                           |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                | shift(f)                   |                                            |                               |                       |
  | fun ->  · fun id                       | shift(i)                  |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                | ----                       |                                            |                               |                       |
  | fun -> · fun lit                       | ----                      | shift(l)            | syntax error                               | syntax error                              | syntax error                               | syntax error                           | syntax error                           | syntax error                            | syntax error                            | syntax error                           | syntax error                            | syntax error                           | syntax error                            | syntax error                           | syntax error                           | syntax error                           | syntax error                             | shift(e)                   | shift(c)       | call -> fun · ( operands ) | syntax error                               | shift(a)                      | syntax error          |
  | fun -> · id                            | expr -> id ·              | reduce to expr      | quit                                       | quit                                      | quit                                       | quit                                   | quit                                   | quit                                    | quit                                    | quit                                   | quit                                    | quit                                   | quit                                    | quit                                   | quit                                   | quit                                   | quit                                     | reduce 3 to cmp expr       | reduce to expr | call -> fun · ( )          | quit                                       | ----                          | quit                  |
  | accessor -> · accessor dot id          | fun -> id ·               | ----                | ----                                       | ----                                      | ----                                       | ----                                   | ----                                   | ----                                    | ----                                    | ----                                   | ----                                    | ----                                   | ----                                    | ----                                   | ----                                   | ----                                   | ----                                     | ----                       | ----           | fun -> fun · id            | ----                                       | expr -> accessor ·            | ----                  |
  | accessor -> · id dot id                | accessor -> id · dot id   |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                | fun -> fun · lit           |                                            | accessor -> accessor · dot id |                       |
  +----------------------------------------+---------------------------+---------------------+--------------------------------------------+-------------------------------------------+--------------------------------------------+----------------------------------------+----------------------------------------+-----------------------------------------+-----------------------------------------+----------------------------------------+-----------------------------------------+----------------------------------------+-----------------------------------------+----------------------------------------+----------------------------------------+----------------------------------------+------------------------------------------+----------------------------+----------------+----------------------------+--------------------------------------------+-------------------------------+-----------------------+
  | cmp-expr -> expr >= · expr             |                           |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | expr -> · call                         |                           |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | expr -> · accessor                     |                           |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | expr -> · lit                          |                           |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | expr -> · id                           |                           |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | call -> · fun ( operands )             |                           |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | call -> · fun ( )                      |                           |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                | shift(f)                   |                                            |                               |                       |
  | fun -> · fun id                        | shift(i)                  |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                | ----                       |                                            |                               |                       |
  | fun -> · fun lit                       | ----                      | shift(l)            | syntax error                               | syntax error                              | syntax error                               | syntax error                           | syntax error                           | syntax error                            | syntax error                            | syntax error                           | syntax error                            | syntax error                           | syntax error                            | syntax error                           | syntax error                           | syntax error                           | syntax error                             | shift(e)                   | shift(c)       | call -> fun · ( operands ) | syntax error                               | shift(a)                      | syntax error          |
  | fun -> · id                            | expr -> id ·              | reduce to expr      | quit                                       | quit                                      | quit                                       | quit                                   | quit                                   | quit                                    | quit                                    | quit                                   | quit                                    | quit                                   | quit                                    | quit                                   | quit                                   | quit                                   | quit                                     | reduce 3 to cmp expr       | reduce to expr | call -> fun · ( )          | quit                                       | ----                          | quit                  |
  | accessor -> · accessor dot id          | fun -> id ·               | ----                | ----                                       | ----                                      | ----                                       | ----                                   | ----                                   | ----                                    | ----                                    | ----                                   | ----                                    | ----                                   | ----                                    | ----                                   | ----                                   | ----                                   | ----                                     | ----                       | ----           | fun -> fun · id            | ----                                       | expr -> accessor ·            | ----                  |
  | accessor -> · id dot id                | accessor -> id · dot id   |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                | fun -> fun · lit           |                                            | accessor -> accessor · dot id |                       |
  +----------------------------------------+---------------------------+---------------------+--------------------------------------------+-------------------------------------------+--------------------------------------------+----------------------------------------+----------------------------------------+-----------------------------------------+-----------------------------------------+----------------------------------------+-----------------------------------------+----------------------------------------+-----------------------------------------+----------------------------------------+----------------------------------------+----------------------------------------+------------------------------------------+----------------------------+----------------+----------------------------+--------------------------------------------+-------------------------------+-----------------------+
  |                                        |                           |                     |                                            |                                           |                                            | shift(d)                               |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     |                                            |                                           |                                            | ----                                   |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     |                                            |                                           |                                            | call -> fun ( · operands )             |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     |                                            |                                           |                                            | call -> fun ( · )                      |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     |                                            |                                           |                                            | operands -> · expr                     |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     |                                            |                                           |                                            | operands -> · operands , expr          |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     |                                            |                                           |                                            | expr -> · call                         |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     |                                            |                                           |                                            | expr -> · accessor                     |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     |                                            |                                           |                                            | expr -> · lit                          |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     |                                            |                                           |                                            | expr -> · id                           |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     |                                            |                                           |                                            | call -> · fun ( operands )             |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     |                                            |                                           |                                            | call -> · fun ( )                      |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     |                                            |                                           |                                            | fun -> · fun id                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | call -> fun · ( operands )             | shift(i)                  | shift(l)            | syntax error                               | syntax error                              | syntax error                               | fun -> · fun lit                       | syntax error                           | syntax error                            | syntax error                            | syntax error                           | syntax error                            | syntax error                           | syntax error                            | syntax error                           | syntax error                           | syntax error                           | syntax error                             | syntax error               | syntax error   | syntax error               | syntax error                               | syntax error                  | syntax error          |
  | call -> fun · ( )                      | reduce 2 to fun           | reduce 2 to fun     | quit                                       | quit                                      | quit                                       | fun -> · id                            | quit                                   | quit                                    | quit                                    | quit                                   | quit                                    | quit                                   | quit                                    | quit                                   | quit                                   | quit                                   | quit                                     | quit                       | quit           | quit                       | quit                                       | quit                          | quit                  |
  | fun -> fun · id                        | ----                      | ----                | ----                                       | ----                                      | ----                                       | accessor -> · accessor dot id          | ----                                   | ----                                    | ----                                    | ----                                   | ----                                    | ----                                   | ----                                    | ----                                   | ----                                   | ----                                   | ----                                     | ----                       | ----           | ----                       | ----                                       | ----                          | ----                  |
  | fun -> fun · lit                       |                           |                     |                                            |                                           |                                            | accessor -> · id dot id                |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  +----------------------------------------+---------------------------+---------------------+--------------------------------------------+-------------------------------------------+--------------------------------------------+----------------------------------------+----------------------------------------+-----------------------------------------+-----------------------------------------+----------------------------------------+-----------------------------------------+----------------------------------------+-----------------------------------------+----------------------------------------+----------------------------------------+----------------------------------------+------------------------------------------+----------------------------+----------------+----------------------------+--------------------------------------------+-------------------------------+-----------------------+
  | call -> fun ( · operands )             |                           |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | call -> fun ( · )                      |                           |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | operands -> · expr                     |                           |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | operands -> · operands , expr          |                           |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | expr -> · call                         |                           |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | expr -> · accessor                     |                           |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | expr -> · lit                          |                           |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | expr -> · id                           |                           |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | call -> · fun ( operands )             |                           |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | call -> · fun ( )                      |                           |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                | shift(f)                   |                                            |                               |                       |
  | fun -> · fun id                        | shift(i)                  |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                | ----                       |                                            |                               |                       |
  | fun -> · fun lit                       | ----                      | shift(l)            | syntax error                               | syntax error                              | syntax error                               | syntax error                           | shift(d)                               | syntax error                            | syntax error                            | syntax error                           | syntax error                            | syntax error                           | syntax error                            | syntax error                           | syntax error                           | syntax error                           | syntax error                             | shift(e)                   | shift(c)       | call -> fun · ( operands ) | shift(o)                                   | shift(a)                      | syntax error          |
  | fun -> · id                            | expr -> id ·              | reduce to expr      | quit                                       | quit                                      | quit                                       | quit                                   | reduce 3 to call                       | quit                                    | quit                                    | quit                                   | quit                                    | quit                                   | quit                                    | quit                                   | quit                                   | quit                                   | quit                                     | reduce 1 to operands       | reduce to expr | call -> fun · ( )          | ----                                       | ----                          | quit                  |
  | accessor -> · accessor dot id          | fun -> id ·               | ----                | ----                                       | ----                                      | ----                                       | ----                                   | ----                                   | ----                                    | ----                                    | ----                                   | ----                                    | ----                                   | ----                                    | ----                                   | ----                                   | ----                                   | ----                                     | ----                       | ----           | fun -> fun · id            | call -> fun ( operands · )                 | expr -> accessor ·            | ----                  |
  | accessor -> · id dot id                | accessor -> id · dot id   |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                | fun -> fun · lit           | operands -> operands · , expr              | accessor -> accessor · dot id |                       |
  +----------------------------------------+---------------------------+---------------------+--------------------------------------------+-------------------------------------------+--------------------------------------------+----------------------------------------+----------------------------------------+-----------------------------------------+-----------------------------------------+----------------------------------------+-----------------------------------------+----------------------------------------+-----------------------------------------+----------------------------------------+----------------------------------------+----------------------------------------+------------------------------------------+----------------------------+----------------+----------------------------+--------------------------------------------+-------------------------------+-----------------------+
  |                                        |                           |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         | shift(d)                               |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         | ----                                   |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         | operands -> operands , · expr          |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         | expr -> · call                         |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         | expr -> · accessor                     |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         | expr -> · lit                          |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         | expr -> · id                           |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         | call -> · fun ( operands )             |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         | call -> · fun ( )                      |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        |                           |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         | fun -> · fun id                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  |                                        | syntax error              | syntax error        | syntax error                               | syntax error                              | syntax error                               | syntax error                           | shift(d)                               | syntax error                            | syntax error                            | syntax error                           | syntax error                            | syntax error                           | syntax error                            | fun -> · fun lit                       | syntax error                           | syntax error                           | syntax error                             | syntax error               | syntax error   | syntax error               | syntax error                               | syntax error                  | syntax error          |
  |                                        | quit                      | quit                | quit                                       | quit                                      | quit                                       | quit                                   | reduce 4 to call                       | quit                                    | quit                                    | quit                                   | quit                                    | quit                                   | quit                                    | fun -> · id                            | quit                                   | quit                                   | quit                                     | quit                       | quit           | quit                       | quit                                       | quit                          | quit                  |
  | call -> fun ( operands · )             | ----                      | ----                | ----                                       | ----                                      | ----                                       | ----                                   | ----                                   | ----                                    | ----                                    | ----                                   | ----                                    | ----                                   | ----                                    | accessor -> · accessor dot id          | ----                                   | ----                                   | ----                                     | ----                       | ----           | ----                       | ----                                       | ----                          | ----                  |
  | operands -> operands · , expr          |                           |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         | accessor -> · id dot id                |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  +----------------------------------------+---------------------------+---------------------+--------------------------------------------+-------------------------------------------+--------------------------------------------+----------------------------------------+----------------------------------------+-----------------------------------------+-----------------------------------------+----------------------------------------+-----------------------------------------+----------------------------------------+-----------------------------------------+----------------------------------------+----------------------------------------+----------------------------------------+------------------------------------------+----------------------------+----------------+----------------------------+--------------------------------------------+-------------------------------+-----------------------+
  | operands -> operands , · expr          |                           |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | expr -> · call                         |                           |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | expr -> · accessor                     |                           |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | expr -> · lit                          |                           |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | expr -> · id                           |                           |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | call -> · fun ( operands )             |                           |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  | call -> · fun ( )                      |                           |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                | shift(f)                   |                                            |                               |                       |
  | fun -> · fun id                        | shift(i)                  |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                | ----                       |                                            |                               |                       |
  | fun -> · fun lit                       | ----                      | shift(l)            | syntax error                               | syntax error                              | syntax error                               | syntax error                           | syntax error                           | syntax error                            | syntax error                            | syntax error                           | syntax error                            | syntax error                           | syntax error                            | syntax error                           | syntax error                           | syntax error                           | syntax error                             | shift(e)                   | shift(c)       | call -> fun · ( operands ) | syntax error                               | shift(a)                      | syntax error          |
  | fun -> · id                            | expr -> id ·              | reduce to expr      | quit                                       | quit                                      | quit                                       | quit                                   | quit                                   | quit                                    | quit                                    | quit                                   | quit                                    | quit                                   | quit                                    | quit                                   | quit                                   | quit                                   | quit                                     | reduce 3 to operands       | reduce to expr | call -> fun · ( )          | quit                                       | ----                          | quit                  |
  | accessor -> · accessor dot id          | fun -> id ·               | ----                | ----                                       | ----                                      | ----                                       | ----                                   | ----                                   | ----                                    | ----                                    | ----                                   | ----                                    | ----                                   | ----                                    | ----                                   | ----                                   | ----                                   | ----                                     | ----                       | ----           | fun -> fun · id            | ----                                       | expr -> accessor ·            | ----                  |
  | accessor -> · id dot id                | accessor -> id · dot id   |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                | fun -> fun · lit           |                                            | accessor -> accessor · dot id |                       |
  +----------------------------------------+---------------------------+---------------------+--------------------------------------------+-------------------------------------------+--------------------------------------------+----------------------------------------+----------------------------------------+-----------------------------------------+-----------------------------------------+----------------------------------------+-----------------------------------------+----------------------------------------+-----------------------------------------+----------------------------------------+----------------------------------------+----------------------------------------+------------------------------------------+----------------------------+----------------+----------------------------+--------------------------------------------+-------------------------------+-----------------------+
  |                                        | reduce 1 to fun           | reduce 1 to fun     | reduce to expr                             | reduce to expr                            | syntax error                               | reduce 1 to fun                        | reduce to expr                         | reduce to expr                          | reduce to expr                          | reduce to expr                         | reduce to expr                          | reduce to expr                         | reduce to expr                          | syntax error                           |                                        | syntax error                           | syntax error                             | syntax error               | syntax error   | syntax error               | syntax error                               | syntax error                  | reduce to expr        |
  | expr -> id ·                           | enqueue(i)                | enqueue(l)          | enqueue(i)                                 | enqueue(i)                                | quit                                       | enqueue(d)                             | enqueue(d)                             | enqueue(d)                              | enqueue(d)                              | enqueue(d)                             | enqueue(d)                              | enqueue(d)                             | enqueue(d)                              | quit                                   | shift(d)                               | quit                                   | quit                                     | quit                       | quit           | quit                       | quit                                       | quit                          | enqueue(e)            |
  | fun -> id ·                            | ----                      | ----                | ----                                       | ----                                      | ----                                       | ----                                   | ----                                   | ----                                    | ----                                    | ----                                   | ----                                    | ----                                   | ----                                    | ----                                   | ----                                   | ----                                   | ----                                     | ----                       | ----           | ----                       | ----                                       | ----                          | ----                  |
  | accessor -> id · dot id                |                           |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        | accessor -> id dot · id                |                                        |                                          |                            |                |                            |                                            |                               |                       |
  +----------------------------------------+---------------------------+---------------------+--------------------------------------------+-------------------------------------------+--------------------------------------------+----------------------------------------+----------------------------------------+-----------------------------------------+-----------------------------------------+----------------------------------------+-----------------------------------------+----------------------------------------+-----------------------------------------+----------------------------------------+----------------------------------------+----------------------------------------+------------------------------------------+----------------------------+----------------+----------------------------+--------------------------------------------+-------------------------------+-----------------------+
  |                                        | syntax error              | syntax error        | reduce to expr                             | reduce to expr                            | syntax error                               | syntax error                           | reduce to expr                         | reduce to expr                          | reduce to expr                          | reduce to expr                         | reduce to expr                          | reduce to expr                         | reduce to expr                          | syntax error                           |                                        | syntax error                           | syntax error                             | syntax error               | syntax error   | syntax error               | syntax error                               | syntax error                  | syntax error          |
  |                                        | quit                      | quit                | enqueue(i)                                 | enqueue(i)                                | quit                                       | quit                                   | enqueue(d)                             | enqueue(d)                              | enqueue(d)                              | enqueue(d)                             | enqueue(d)                              | enqueue(d)                             | enqueue(d)                              | quit                                   | shift(d)                               | quit                                   | quit                                     | quit                       | quit           | quit                       | quit                                       | quit                          | quit                  |
  | expr -> accessor ·                     | ----                      | ----                | ----                                       | ----                                      | ----                                       | ----                                   | ----                                   | ----                                    | ----                                    | ----                                   | ----                                    | ----                                   | ----                                    | ----                                   | ----                                   | ----                                   | ----                                     | ----                       | ----           | ----                       | ----                                       | ----                          | ----                  |
  | accessor -> accessor · dot id          |                           |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        | accessor -> accessor dot · id          |                                        |                                          |                            |                |                            |                                            |                               |                       |
  +----------------------------------------+---------------------------+---------------------+--------------------------------------------+-------------------------------------------+--------------------------------------------+----------------------------------------+----------------------------------------+-----------------------------------------+-----------------------------------------+----------------------------------------+-----------------------------------------+----------------------------------------+-----------------------------------------+----------------------------------------+----------------------------------------+----------------------------------------+------------------------------------------+----------------------------+----------------+----------------------------+--------------------------------------------+-------------------------------+-----------------------+
  |                                        | shift(i)                  | syntax error        | syntax error                               | syntax error                              | syntax error                               | syntax error                           | syntax error                           | syntax error                            | syntax error                            | syntax error                           | syntax error                            | syntax error                           | syntax error                            | syntax error                           | syntax error                           | syntax error                           | syntax error                             | syntax error               | syntax error   | syntax error               | syntax error                               | syntax error                  | syntax error          |
  |                                        | reduce to accessor        | quit                | quit                                       | quit                                      | quit                                       | quit                                   | quit                                   | quit                                    | quit                                    | quit                                   | quit                                    | quit                                   | quit                                    | quit                                   | quit                                   | quit                                   | quit                                     | quit                       | quit           | quit                       | quit                                       | quit                          | quit                  |
  |                                        | ----                      | ----                | ----                                       | ----                                      | ----                                       | ----                                   | ----                                   | ----                                    | ----                                    | ----                                   | ----                                    | ----                                   | ----                                    | ----                                   | ----                                   | ----                                   | ----                                     | ----                       | ----           | ----                       | ----                                       | ----                          | ----                  |
  | accessor -> accessor dot · id          |                           |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  +----------------------------------------+---------------------------+---------------------+--------------------------------------------+-------------------------------------------+--------------------------------------------+----------------------------------------+----------------------------------------+-----------------------------------------+-----------------------------------------+----------------------------------------+-----------------------------------------+----------------------------------------+-----------------------------------------+----------------------------------------+----------------------------------------+----------------------------------------+------------------------------------------+----------------------------+----------------+----------------------------+--------------------------------------------+-------------------------------+-----------------------+
  |                                        | shift(i)                  | syntax error        | syntax error                               | syntax error                              | syntax error                               | syntax error                           | syntax error                           | syntax error                            | syntax error                            | syntax error                           | syntax error                            | syntax error                           | syntax error                            | syntax error                           | syntax error                           | syntax error                           | syntax error                             | syntax error               | syntax error   | syntax error               | syntax error                               | syntax error                  | syntax error          |
  |                                        | reduce to accessor        | quit                | quit                                       | quit                                      | quit                                       | quit                                   | quit                                   | quit                                    | quit                                    | quit                                   | quit                                    | quit                                   | quit                                    | quit                                   | quit                                   | quit                                   | quit                                     | quit                       | quit           | quit                       | quit                                       | quit                          | quit                  |
  |                                        | ----                      | ----                | ----                                       | ----                                      | ----                                       | ----                                   | ----                                   | ----                                    | ----                                    | ----                                   | ----                                    | ----                                   | ----                                    | ----                                   | ----                                   | ----                                   | ----                                     | ----                       | ----           | ----                       | ----                                       | ----                          | ----                  |
  | accessor -> id dot · id                |                           |                     |                                            |                                           |                                            |                                        |                                        |                                         |                                         |                                        |                                         |                                        |                                         |                                        |                                        |                                        |                                          |                            |                |                            |                                            |                               |                       |
  +----------------------------------------+---------------------------+---------------------+--------------------------------------------+-------------------------------------------+--------------------------------------------+----------------------------------------+----------------------------------------+-----------------------------------------+-----------------------------------------+----------------------------------------+-----------------------------------------+----------------------------------------+-----------------------------------------+----------------------------------------+----------------------------------------+----------------------------------------+------------------------------------------+----------------------------+----------------+----------------------------+--------------------------------------------+-------------------------------+-----------------------+
#+end_src

*** context
#+begin_src python :noweb-ref guard-context
  class _GuardContext:
    guard: BoolExpression

    def __init__(self, fsm = None):
      self.fsm = fsm
      self.queue = []
      self.delay_queue = []
      self.state_stack = []
      self.stack = []
      self.guard = None
#+end_src
*** delegate
#+begin_src python :noweb-ref guard-delegate
  class _GuardActionDelegate(GuardActionDelegate):

    def shift(self, ctx, l):
      ctx.state_stack.append(ctx.fsm.state)
      ctx.stack.append(l)

    def syntax_error(self, ctx):
      print("syntax error in guard syntaxer")

    def quit(self, ctx):
      exit(1)

    def enqueue(self, ctx, e):
      ctx.delay_queue.append(e)

    def reduce_to_guard(self, ctx):
      ctx.fsm.state = ctx.state_stack.pop()
      ctx.fsm.state = ctx.state_stack.pop()
      ctx.stack.pop()
      ctx.guard = ctx.stack.pop()

    def reduce_1_to_bool_expr(self, ctx):
      ctx.fsm.state = ctx.state_stack.pop()
      expr = ctx.stack.pop()
      ctx.queue.append(BoolExpression(expr))

    def reduce_2_to_bool_expr(self, ctx):
      ctx.fsm.state = ctx.state_stack.pop()
      expr = ctx.stack.pop()
      ctx.fsm.state = ctx.state_stack.pop()
      op = ctx.stack.pop()
      ctx.queue.append(UnaryBoolExpression(op, expr))

    def reduce_3_to_bool_expr(self, ctx):
      ctx.fsm.state = ctx.state_stack.pop()
      expr2 = ctx.stack.pop()
      ctx.fsm.state = ctx.state_stack.pop()
      op = ctx.stack.pop()
      ctx.fsm.state = ctx.state_stack.pop()
      expr1 = ctx.stack.pop()
      ctx.queue.append(BinaryBoolExpression(expr1, op, expr2))

    def reduce_3_to_cmp_expr(self, ctx):
      ctx.fsm.state = ctx.state_stack.pop()
      expr2 = ctx.stack.pop()
      ctx.fsm.state = ctx.state_stack.pop()
      op = ctx.stack.pop()
      ctx.fsm.state = ctx.state_stack.pop()
      expr1 = ctx.stack.pop()
      ctx.queue.append(CompareExpression(expr1, op, expr2))

    def reduce_to_expr(self, ctx):
      ctx.fsm.state = ctx.state_stack.pop()
      expr = ctx.stack.pop()
      ctx.queue.append(Expression(expr))

    def reduce_3_to_call(self, ctx):
      ctx.fsm.state = ctx.state_stack.pop()
      ctx.stack.pop()
      ctx.fsm.state = ctx.state_stack.pop()
      ctx.stack.pop()
      ctx.fsm.state = ctx.state_stack.pop()
      fun = ctx.stack.pop()
      ctx.queue.append(Call(fun, []))

    def reduce_4_to_call(self, ctx):
      ctx.fsm.state = ctx.state_stack.pop()
      ctx.stack.pop()
      ctx.fsm.state = ctx.state_stack.pop()
      operands = ctx.stack.pop()
      ctx.fsm.state = ctx.state_stack.pop()
      ctx.stack.pop()
      ctx.fsm.state = ctx.state_stack.pop()
      fun = ctx.stack.pop()
      ctx.queue.append(Call(fun, operands))

    def reduce_1_to_fun(self, ctx):
      ctx.fsm.state = ctx.state_stack.pop()
      id = ctx.stack.pop()
      ctx.queue.append(Fun(id))

    def reduce_2_to_fun(self, ctx):
      ctx.fsm.state = ctx.state_stack.pop()
      id = ctx.stack.pop()
      ctx.fsm.state = ctx.state_stack.pop()
      fun = ctx.stack.pop()
      fun.names.append(id)
      ctx.queue.append(fun)

    def reduce_1_to_operands(self, ctx):
      ctx.fsm.state = ctx.state_stack.pop()
      expr = ctx.stack.pop()
      ctx.queue.append([expr.entity])

    def reduce_3_to_operands(self, ctx):
      ctx.fsm.state = ctx.state_stack.pop()
      expr = ctx.stack.pop()
      ctx.fsm.state = ctx.state_stack.pop()
      ctx.stack.pop()
      ctx.fsm.state = ctx.state_stack.pop()
      operands = ctx.stack.pop()
      operands.append(expr.entity)
      ctx.queue.append(operands)

    def reduce_to_accessor(self, ctx):
      ctx.fsm.state = ctx.state_stack.pop()
      id = ctx.stack.pop()
      ctx.fsm.state = ctx.state_stack.pop()
      ctx.stack.pop()
      ctx.fsm.state = ctx.state_stack.pop()
      accessor_or_id = ctx.stack.pop()
      if isinstance(accessor_or_id, Identifier):
        ctx.queue.append(Accessor([accessor_or_id, id]))
      else:
        accessor_or_id.accessors.append(id)
        ctx.queue.append(accessor_or_id)
#+end_src
*** lex adapter
#+begin_src python :noweb-ref guard-adapter
  class GuardLexerAdapter:

    def __init__(self, syntaxer: GuardSyntaxer):
      self._syntaxer = syntaxer

    def on_call(self, token):
      if isinstance(token, Identifier):
        self._syntaxer.identifier(token)
      elif isinstance(token, Literal):
        self._syntaxer.literal(token)
      elif isinstance(token, Delimiter):
        self._syntaxer.delimiter(token)
      else:
        print('Unknown token in parameter lexer adapter: %s' % (repr(token)))
        exit(1)
#+end_src
** action syntaxer
*** framework
#+begin_src python :noweb-ref action
  <<action-context>>


  <<action-delegate>>


  class ActionSyntaxer:

    def __init__(self):
      self._fsm = ActionStateMachine(_ActionActionDelegate(), None, None)
      self._ctx = _ActionContext(self._fsm)

    def identifier(self, id):
      self._consume_queue()
      self._ctx.input = id
      self._fsm.identifier(self._ctx, id)
      self._consume_queue()

    def literal(self, l):
      self._consume_queue()
      self._ctx.input = l
      self._fsm.literal(self._ctx, l)
      self._consume_queue()

    def delimiter(self, d):
      self._consume_queue()
      self._ctx.input = d
      self._fsm.delimiter(self._ctx, d)
      self._consume_queue()

    def eof(self):
      self._consume_queue()
      self._ctx.input = 'eof'
      self._fsm.eof(self._ctx, 0)
      self._consume_queue()

    def result(self):
      return self._ctx.action

    def _consume_queue(self):
      while len(self._ctx.queue) > 0:
        n = self._ctx.queue[0]
        self._ctx.queue = self._ctx.queue[1:]
        self._ctx.input = n
        self._feed(n)
      while len(self._ctx.delay_queue) > 0:
        while len(self._ctx.queue) > 0:
          n = self._ctx.queue[0]
          self._ctx.queue = self._ctx.queue[1:]
          self._ctx.input = n
          self._feed(n)
        d = self._ctx.delay_queue[0]
        self._ctx.delay_queue = self._ctx.delay_queue[1:]
        self._ctx.input = d
        self._feed(d)

    def _feed(self, n):
      if isinstance(n, Assignment):
        self._fsm.assignment(self._ctx, n)
      elif isinstance(n, Call):
        self._fsm.call(self._ctx, n)
      elif isinstance(n, Fun):
        self._fsm.fun(self._ctx, n)
      elif isinstance(n, Identifier):
        self._fsm.identifier(self._ctx, n)
      elif isinstance(n, Literal):
        self._fsm.literal(self._ctx, n)
      elif isinstance(n, Delimiter):
        self._fsm.delimiter(self._ctx, n)
      elif isinstance(n, list):
        self._fsm.operands(self._ctx, n)
      elif isinstance(n, int):
        self._fsm.eof(self._ctx, n)


  <<action-adapter>>
#+end_src
*** bnf
#+begin_src text
  action = assignment
         | call

  assignment = identifier : identifier = call
             | identifier = call

  call = fun ( operands )
       | fun ( )
       | fun

  fun = fun identifier
      | fun literal
      | identifier

  operands = literal
           | identifier
           | operands , literal
           | operands , identifier
#+end_src
*** fsm defination
#+begin_src text :tangle ${BUILDDIR}/action_fsm.txt
  +------------------------------------------------+---------------------------+---------------------------+----------------------------+-------------------------------------+------------------------------------------------+----------------------+------------------------------------------------+----------------------------------------+----------------------------------------+------------------------------------------------+----------------------------------------+------------------+
  | state\event                                    | assignment(a: assignment) | call(c: call)             | fun(f: fun)                | operands(o: [identifier | literal]) | identifier(i: identifier)                      | literal(l: literal)  | delimiter(d: delimiter)[d.name == ':']         | delimiter(d: delimiter)[d.name == '('] | delimiter(d: delimiter)[d.name == ')'] | delimiter(d: delimiter)[d.name == '=']         | delimiter(d: delimiter)[d.name == ','] | eof(e: int)      |
  +------------------------------------------------+---------------------------+---------------------------+----------------------------+-------------------------------------+------------------------------------------------+----------------------+------------------------------------------------+----------------------------------------+----------------------------------------+------------------------------------------------+----------------------------------------+------------------+
  | action -> · assignment $$                      |                           |                           |                            |                                     |                                                |                      |                                                |                                        |                                        |                                                |                                        |                  |
  | action -> · call $$                            |                           |                           |                            |                                     |                                                |                      |                                                |                                        |                                        |                                                |                                        |                  |
  | assignment -> · identifier : identifier = call |                           |                           |                            |                                     |                                                |                      |                                                |                                        |                                        |                                                |                                        |                  |
  | assignment -> · identifier = call              |                           |                           | shift(f)                   |                                     |                                                |                      |                                                |                                        |                                        |                                                |                                        |                  |
  | call -> · fun ( operands )                     |                           |                           | ----                       |                                     |                                                |                      |                                                |                                        |                                        |                                                |                                        |                  |
  | call -> · fun ( )                              |                           |                           | call -> fun · ( operands ) |                                     | shift(i)                                       |                      |                                                |                                        |                                        |                                                |                                        |                  |
  | call -> · fun                                  |                           |                           | call -> fun · ( )          | syntax error                        | ----                                           | syntax error         | syntax error                                   | syntax error                           | syntax error                           | syntax error                                   | syntax error                           | syntax error     |
  | fun -> · fun identifier                        | shift(a)                  | shift(c)                  | call -> fun ·              | quit                                | assignment -> identifier · : identifier = call | quit                 | quit                                           | quit                                   | quit                                   | quit                                           | quit                                   | quit             |
  | fun -> · fun literal                           | ----                      | ----                      | fun -> fun · identifier    | ----                                | assignment -> identifier · = call              | ----                 | ----                                           | ----                                   | ----                                   | ----                                           | ----                                   | ----             |
  | fun -> · identifier                            | action -> assignment · $$ | action -> call · $$       | fun -> fun · literal       |                                     | fun -> identifier ·                            |                      |                                                |                                        |                                        |                                                |                                        |                  |
  +------------------------------------------------+---------------------------+---------------------------+----------------------------+-------------------------------------+------------------------------------------------+----------------------+------------------------------------------------+----------------------------------------+----------------------------------------+------------------------------------------------+----------------------------------------+------------------+
  |                                                | syntax error              | syntax error              | syntax error               | syntax error                        | syntax error                                   | syntax error         | syntax error                                   | syntax error                           | syntax error                           | syntax error                                   | syntax error                           | shift(e)         |
  |                                                | quit                      | quit                      | quit                       | quit                                | quit                                           | quit                 | quit                                           | quit                                   | quit                                   | quit                                           | quit                                   | reduce to action |
  |                                                | ----                      | ----                      | ----                       | ----                                | ----                                           | ----                 | ----                                           | ----                                   | ----                                   | ----                                           | ----                                   | ----             |
  | action -> assignment · $$                      |                           |                           |                            |                                     |                                                |                      |                                                |                                        |                                        |                                                |                                        |                  |
  +------------------------------------------------+---------------------------+---------------------------+----------------------------+-------------------------------------+------------------------------------------------+----------------------+------------------------------------------------+----------------------------------------+----------------------------------------+------------------------------------------------+----------------------------------------+------------------+
  |                                                | syntax error              | syntax error              | syntax error               | syntax error                        | syntax error                                   | syntax error         | syntax error                                   | syntax error                           | syntax error                           | syntax error                                   | syntax error                           | shift(e)         |
  |                                                | quit                      | quit                      | quit                       | quit                                | quit                                           | quit                 | quit                                           | quit                                   | quit                                   | quit                                           | quit                                   | reduce to action |
  |                                                | ----                      | ----                      | ----                       | ----                                | ----                                           | ----                 | ----                                           | ----                                   | ----                                   | ----                                           | ----                                   | ----             |
  | action -> call · $$                            |                           |                           |                            |                                     |                                                |                      |                                                |                                        |                                        |                                                |                                        |                  |
  +------------------------------------------------+---------------------------+---------------------------+----------------------------+-------------------------------------+------------------------------------------------+----------------------+------------------------------------------------+----------------------------------------+----------------------------------------+------------------------------------------------+----------------------------------------+------------------+
  |                                                |                           |                           |                            |                                     |                                                |                      |                                                |                                        |                                        | shift(d)                                       |                                        |                  |
  |                                                |                           |                           |                            |                                     |                                                |                      |                                                |                                        |                                        | ----                                           |                                        |                  |
  |                                                |                           |                           |                            |                                     |                                                |                      |                                                |                                        |                                        | assignment -> identifier = · call              |                                        |                  |
  |                                                |                           |                           |                            |                                     |                                                |                      |                                                |                                        |                                        | call -> · fun ( operands )                     |                                        |                  |
  |                                                |                           |                           |                            |                                     |                                                |                      |                                                |                                        |                                        | call -> · fun ( )                              |                                        |                  |
  |                                                | syntax error              | syntax error              | syntax error               | syntax error                        | reduce 1 to fun                                | reduce 1 to fun      |                                                | reduce 1 to fun                        | syntax error                           | call -> · fun                                  | syntax error                           | reduce 1 to fun  |
  | assignment -> identifier · : identifier = call | quit                      | quit                      | quit                       | quit                                | enqueue(i)                                     | enqueue(l)           | shift(d)                                       | enqueue(d)                             | quit                                   | fun -> · fun identifier                        | quit                                   | enqueue(e)       |
  | assignment -> identifier · = call              | ----                      | ----                      | ----                       | ----                                | ----                                           | ----                 | ----                                           | ----                                   | ----                                   | fun -> · fun literal                           | ----                                   | ----             |
  | fun -> identifier ·                            |                           |                           |                            |                                     |                                                |                      | assignment -> identifier : · identifier = call |                                        |                                        | fun -> · identifier                            |                                        |                  |
  +------------------------------------------------+---------------------------+---------------------------+----------------------------+-------------------------------------+------------------------------------------------+----------------------+------------------------------------------------+----------------------------------------+----------------------------------------+------------------------------------------------+----------------------------------------+------------------+
  |                                                | syntax error              | syntax error              | syntax error               | syntax error                        |                                                | syntax error         | syntax error                                   | syntax error                           | syntax error                           |                                                | syntax error                           | syntax error     |
  |                                                | quit                      | quit                      | quit                       | quit                                | shift(i)                                       | quit                 | quit                                           | quit                                   | quit                                   |                                                | quit                                   | quit             |
  |                                                | ----                      | ----                      | ----                       | ----                                | ----                                           | ----                 | ----                                           | ----                                   | ----                                   |                                                | ----                                   | ----             |
  | assignment -> identifier : · identifier = call |                           |                           |                            |                                     | assignment -> identifier : identifier · = call |                      |                                                |                                        |                                        |                                                |                                        |                  |
  +------------------------------------------------+---------------------------+---------------------------+----------------------------+-------------------------------------+------------------------------------------------+----------------------+------------------------------------------------+----------------------------------------+----------------------------------------+------------------------------------------------+----------------------------------------+------------------+
  |                                                |                           |                           |                            |                                     |                                                |                      |                                                |                                        |                                        | shift(d)                                       |                                        |                  |
  |                                                |                           |                           |                            |                                     |                                                |                      |                                                |                                        |                                        | ----                                           |                                        |                  |
  |                                                |                           |                           |                            |                                     |                                                |                      |                                                |                                        |                                        | assignment -> identifier : identifier = · call |                                        |                  |
  |                                                |                           |                           |                            |                                     |                                                |                      |                                                |                                        |                                        | call -> · fun ( operands )                     |                                        |                  |
  |                                                |                           |                           |                            |                                     |                                                |                      |                                                |                                        |                                        | call -> · fun ( )                              |                                        |                  |
  |                                                | syntax error              | syntax error              | syntax error               | syntax error                        |                                                | syntax error         | syntax error                                   | syntax error                           | syntax error                           | call -> · fun                                  | syntax error                           | syntax error     |
  |                                                | quit                      | quit                      | quit                       | quit                                |                                                | quit                 | quit                                           | quit                                   | quit                                   | fun -> · fun identifier                        | quit                                   | quit             |
  |                                                | ----                      | ----                      | ----                       | ----                                |                                                | ----                 | ----                                           | ----                                   | ----                                   | fun -> · fun literal                           | ----                                   | ----             |
  | assignment -> identifier : identifier · = call |                           |                           |                            |                                     |                                                |                      |                                                |                                        |                                        | fun -> · identifier                            |                                        |                  |
  +------------------------------------------------+---------------------------+---------------------------+----------------------------+-------------------------------------+------------------------------------------------+----------------------+------------------------------------------------+----------------------------------------+----------------------------------------+------------------------------------------------+----------------------------------------+------------------+
  | assignment -> identifier : identifier = · call |                           |                           | shift(f)                   |                                     |                                                |                      |                                                |                                        |                                        |                                                |                                        |                  |
  | call -> · fun ( operands )                     |                           |                           | ----                       |                                     |                                                |                      |                                                |                                        |                                        |                                                |                                        |                  |
  | call -> · fun ( )                              |                           |                           | call -> fun · ( operands ) |                                     |                                                |                      |                                                |                                        |                                        |                                                |                                        |                  |
  | call -> · fun                                  | syntax error              | shift(c)                  | call -> fun · ( )          | syntax error                        | shift(i)                                       | syntax error         | syntax error                                   | syntax error                           | syntax error                           | syntax error                                   | syntax error                           | syntax error     |
  | fun -> · fun identifier                        | quit                      | reduce 5 to assignment(c) | call -> fun ·              | quit                                | reduce 1 to fun                                | quit                 | quit                                           | quit                                   | quit                                   | quit                                           | quit                                   | quit             |
  | fun -> · fun literal                           | ----                      | ----                      | fun -> fun · identifier    | ----                                | ----                                           | ----                 | ----                                           | ----                                   | ----                                   | ----                                           | ----                                   | ----             |
  | fun -> · identifier                            |                           |                           | fun -> fun · literal       |                                     |                                                |                      |                                                |                                        |                                        |                                                |                                        |                  |
  +------------------------------------------------+---------------------------+---------------------------+----------------------------+-------------------------------------+------------------------------------------------+----------------------+------------------------------------------------+----------------------------------------+----------------------------------------+------------------------------------------------+----------------------------------------+------------------+
  | assignment -> identifier = · call              |                           |                           | shift(f)                   |                                     |                                                |                      |                                                |                                        |                                        |                                                |                                        |                  |
  | call -> · fun ( operands )                     |                           |                           | ----                       |                                     |                                                |                      |                                                |                                        |                                        |                                                |                                        |                  |
  | call -> · fun ( )                              |                           |                           | call -> fun · ( operands ) |                                     |                                                |                      |                                                |                                        |                                        |                                                |                                        |                  |
  | call -> · fun                                  | syntax error              | shift(c)                  | call -> fun · ( )          | syntax error                        | shift(i)                                       | syntax error         | syntax error                                   | syntax error                           | syntax error                           | syntax error                                   | syntax error                           | syntax error     |
  | fun -> · fun identifier                        | quit                      | reduce 3 to assignment(c) | call -> fun ·              | quit                                | reduce 1 to fun                                | quit                 | quit                                           | quit                                   | quit                                   | quit                                           | quit                                   | quit             |
  | fun -> · fun literal                           | ----                      | ----                      | fun -> fun · identifier    | ----                                | ----                                           | ----                 | ----                                           | ----                                   | ----                                   | ----                                           | ----                                   | ----             |
  | fun -> · identifier                            |                           |                           | fun -> fun · literal       |                                     |                                                |                      |                                                |                                        |                                        |                                                |                                        |                  |
  +------------------------------------------------+---------------------------+---------------------------+----------------------------+-------------------------------------+------------------------------------------------+----------------------+------------------------------------------------+----------------------------------------+----------------------------------------+------------------------------------------------+----------------------------------------+------------------+
  |                                                |                           |                           |                            |                                     |                                                |                      |                                                | shift(d)                               |                                        |                                                |                                        |                  |
  |                                                |                           |                           |                            |                                     |                                                |                      |                                                | ----                                   |                                        |                                                |                                        |                  |
  |                                                |                           |                           |                            |                                     |                                                |                      |                                                | call -> fun ( · operands )             |                                        |                                                |                                        |                  |
  | call -> fun · ( operands )                     |                           |                           |                            |                                     |                                                |                      |                                                | call -> fun ( · )                      |                                        |                                                |                                        |                  |
  | call -> fun · ( )                              | syntax error              | syntax error              | syntax error               | syntax error                        | shift(i)                                       | shift(l)             | syntax error                                   | operands -> · operands , literal       | syntax error                           | syntax error                                   | syntax error                           | reduce 1 to call |
  | call -> fun ·                                  | quit                      | quit                      | quit                       | quit                                | reduce 2 to fun                                | reduce 2 to fun      | quit                                           | operands -> · operands , identifier    | quit                                   | quit                                           | quit                                   | enqueue(e)       |
  | fun -> fun · identifier                        | ----                      | ----                      | ----                       | ----                                | ----                                           | ----                 | ----                                           | operands -> · literal                  | ----                                   | ----                                           | ----                                   | ----             |
  | fun -> fun · literal                           |                           |                           |                            |                                     |                                                |                      |                                                | operands -> · identifier               |                                        |                                                |                                        |                  |
  +------------------------------------------------+---------------------------+---------------------------+----------------------------+-------------------------------------+------------------------------------------------+----------------------+------------------------------------------------+----------------------------------------+----------------------------------------+------------------------------------------------+----------------------------------------+------------------+
  | call -> fun ( · operands )                     |                           |                           |                            |                                     |                                                |                      |                                                |                                        |                                        |                                                |                                        |                  |
  | call -> fun ( · )                              |                           |                           |                            | shift(o)                            |                                                |                      |                                                |                                        |                                        |                                                |                                        |                  |
  | operands -> · operands , literal               | syntax error              | syntax error              | syntax error               | ----                                | shift(i)                                       | shift(l)             | syntax error                                   | syntax error                           | shift(d)                               | syntax error                                   | shift(d)                               | syntax error     |
  | operands -> · operands , identifier            | quit                      | quit                      | quit                       | call -> fun ( operands · )          | reduce 1 to operands                           | reduce 1 to operands | quit                                           | quit                                   | reduce 3 to call                       | quit                                           | ----                                   | quit             |
  | operands -> · literal                          | ----                      | ----                      | ----                       | operands -> operands · , literal    | ----                                           | ----                 | ----                                           | ----                                   | ----                                   | ----                                           | operands -> operands , · literal       | ----             |
  | operands -> · identifier                       |                           |                           |                            | operands -> operands · , identifier |                                                |                      |                                                |                                        |                                        |                                                | operands -> operands , · identifier    |                  |
  +------------------------------------------------+---------------------------+---------------------------+----------------------------+-------------------------------------+------------------------------------------------+----------------------+------------------------------------------------+----------------------------------------+----------------------------------------+------------------------------------------------+----------------------------------------+------------------+
  |                                                | syntax error              | syntax error              | syntax error               | syntax error                        | syntax error                                   | syntax error         | syntax error                                   | syntax error                           | shift(d)                               | syntax error                                   | shift(d)                               | syntax error     |
  | call -> fun ( operands · )                     | quit                      | quit                      | quit                       | quit                                | quit                                           | quit                 | quit                                           | quit                                   | reduce 4 to call                       | quit                                           | ----                                   | quit             |
  | operands -> operands · , literal               | ----                      | ----                      | ----                       | ----                                | ----                                           | ----                 | ----                                           | ----                                   | ----                                   | ----                                           | operands -> operands , · literal       | ----             |
  | operands -> operands · , identifier            |                           |                           |                            |                                     |                                                |                      |                                                |                                        |                                        |                                                | operands -> operands , · identifier    |                  |
  +------------------------------------------------+---------------------------+---------------------------+----------------------------+-------------------------------------+------------------------------------------------+----------------------+------------------------------------------------+----------------------------------------+----------------------------------------+------------------------------------------------+----------------------------------------+------------------+
  |                                                | syntax error              | syntax error              | syntax error               | syntax error                        | shift(i)                                       | shift(l)             | syntax error                                   | syntax error                           | syntax error                           | syntax error                                   | syntax error                           | syntax error     |
  |                                                | quit                      | quit                      | quit                       | quit                                | reduce 2 to operands                           | reduce 2 to operands | quit                                           | quit                                   | quit                                   | quit                                           | quit                                   | quit             |
  | operands -> operands , · literal               | ----                      | ----                      | ----                       | ----                                | ----                                           | ----                 | ----                                           | ----                                   | ----                                   | ----                                           | ----                                   | ----             |
  | operands -> operands , · identifier            |                           |                           |                            |                                     |                                                |                      |                                                |                                        |                                        |                                                |                                        |                  |
  +------------------------------------------------+---------------------------+---------------------------+----------------------------+-------------------------------------+------------------------------------------------+----------------------+------------------------------------------------+----------------------------------------+----------------------------------------+------------------------------------------------+----------------------------------------+------------------+
#+end_src

*** context
#+begin_src python :noweb-ref action-context
  class _ActionContext:
    action: Union[Assignment, Call]

    def __init__(self, fsm = None):
      self.fsm = fsm
      self.queue = []
      self.delay_queue = []
      self.state_stack = []
      self.stack = []
      self.action = None
      self.input = None
#+end_src
*** delegate
#+begin_src python :noweb-ref action-delegate
  class _ActionActionDelegate(ActionActionDelegate):

    def shift(self, ctx, l):
      ctx.state_stack.append(ctx.fsm.state)
      ctx.stack.append(l)

    def syntax_error(self, ctx):
      print("syntax error in action syntaxer")
      print("current state: %d" % ctx.fsm.state)
      print("stack: %s" % ctx.stack)
      print("state stack: %s" % ctx.state_stack)
      print("input: %s" % ctx.input)

    def quit(self, ctx):
      exit(1)

    def reduce_to_action(self, ctx):
      ctx.fsm.state = ctx.state_stack.pop()
      ctx.fsm.state = ctx.state_stack.pop()
      ctx.stack.pop()
      ctx.action = ctx.stack.pop()

    def reduce_1_to_fun(self, ctx):
      ctx.fsm.state = ctx.state_stack.pop()
      id = ctx.stack.pop()
      ctx.queue.append(Fun(id))

    def enqueue(self, ctx, e):
      ctx.delay_queue.append(e)

    def reduce_5_to_assignment(self, ctx, c):
      ctx.fsm.state = ctx.state_stack.pop()
      call = ctx.stack.pop()
      ctx.fsm.state = ctx.state_stack.pop()
      ctx.stack.pop()
      ctx.fsm.state = ctx.state_stack.pop()
      type = ctx.stack.pop()
      ctx.fsm.state = ctx.state_stack.pop()
      ctx.stack.pop()
      ctx.fsm.state = ctx.state_stack.pop()
      id = ctx.stack.pop()
      ctx.queue.append(Assignment(id, type, call))

    def reduce_3_to_assignment(self, ctx, c):
      ctx.fsm.state = ctx.state_stack.pop()
      call = ctx.stack.pop()
      ctx.fsm.state = ctx.state_stack.pop()
      ctx.stack.pop()
      ctx.fsm.state = ctx.state_stack.pop()
      id = ctx.stack.pop()
      ctx.queue.append(Assignment(id, None, call))

    def reduce_2_to_fun(self, ctx):
      ctx.fsm.state = ctx.state_stack.pop()
      id = ctx.stack.pop()
      ctx.fsm.state = ctx.state_stack.pop()
      fun = ctx.stack.pop()
      fun.names.append(id)
      ctx.queue.append(fun)

    def reduce_1_to_call(self, ctx):
      ctx.fsm.state = ctx.state_stack.pop()
      fun = ctx.stack.pop()
      ctx.queue.append(Call(fun, []))

    def reduce_1_to_operands(self, ctx):
      ctx.fsm.state = ctx.state_stack.pop()
      operand = ctx.stack.pop()
      ctx.queue.append([operand])

    def reduce_3_to_call(self, ctx):
      ctx.fsm.state = ctx.state_stack.pop()
      ctx.stack.pop()
      ctx.fsm.state = ctx.state_stack.pop()
      ctx.stack.pop()
      ctx.fsm.state = ctx.state_stack.pop()
      fun = ctx.stack.pop()
      ctx.queue.append(Call(fun, []))

    def reduce_4_to_call(self, ctx):
      ctx.fsm.state = ctx.state_stack.pop()
      ctx.stack.pop()
      ctx.fsm.state = ctx.state_stack.pop()
      operands = ctx.stack.pop()
      ctx.fsm.state = ctx.state_stack.pop()
      ctx.stack.pop()
      ctx.fsm.state = ctx.state_stack.pop()
      fun = ctx.stack.pop()
      ctx.queue.append(Call(fun, operands))

    def reduce_2_to_operands(self, ctx):
      ctx.fsm.state = ctx.state_stack.pop()
      operand1 = ctx.stack.pop()
      ctx.fsm.state = ctx.state_stack.pop()
      operand2 = ctx.stack.pop()
      ctx.queue.append(operand2 + operand1)
#+end_src
*** lex adapter
#+begin_src python :noweb-ref action-adapter
  class ActionLexerAdapter:

    def __init__(self, syntaxer: ActionSyntaxer):
      self._syntaxer = syntaxer

    def on_call(self, token):
      if isinstance(token, Identifier):
        self._syntaxer.identifier(token)
      elif isinstance(token, Literal):
        self._syntaxer.literal(token)
      elif isinstance(token, Delimiter):
        self._syntaxer.delimiter(token)
      else:
        print('Unknown token in parameter lexer adapter: %s' % (repr(token)))
        exit(1)
#+end_src
** utility
*** framework
#+begin_src python :noweb-ref utility
  <<find-call-in-expression>>
#+end_src
*** find call in expression
#+begin_src python :noweb-ref find-call-in-expression
  def find_call_in_expression(exp: Expression):
    if isinstance(exp, Call):
      yield exp
    elif isinstance(exp, BinaryBoolExpression):
      for x in find_call_in_expression(exp.left):
        yield x
      for y in find_call_in_expression(exp.right):
        yield y
    elif isinstance(exp, UnaryBoolExpression):
      for x in find_call_in_expression(exp.expr):
        yield x
    elif isinstance(exp, CompareExpression):
      for x in find_call_in_expression(exp.left):
        yield x
      for y in find_call_in_expression(exp.right):
        yield y
    elif isinstance(exp, BoolExpression):
      for x in find_call_in_expression(exp.expr):
        yield x
    elif isinstance(exp, Expression):
      for x in find_call_in_expression(exp.entity):
        yield x
#+end_src
